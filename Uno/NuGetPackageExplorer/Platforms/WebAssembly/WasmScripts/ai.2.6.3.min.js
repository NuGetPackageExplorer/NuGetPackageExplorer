/*!
 * Application Insights JavaScript SDK - Web, 2.6.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var e = this, t = function (e) { "use strict"; var r = { Unknown: 0, NonRetryableStatus: 1, InvalidEvent: 2, SizeLimitExceeded: 3, KillSwitch: 4, QueueFull: 5 }, o = "function", w = "object", s = "undefined", D = "prototype", a = "hasOwnProperty", n = Object, c = n[D], t = n.assign, i = n.create, u = n.defineProperty, l = c[a]; function M() { return typeof globalThis !== s && globalThis ? globalThis : typeof self !== s && self ? self : typeof window !== s && window ? window : typeof global !== s && global ? global : null } function d(e) { throw new TypeError(e) } function f(e) { if (i) return i(e); if (null == e) return {}; var t = typeof e; function n() { } return t !== w && t !== o && d("Object prototype may only be an Object:" + e), n[D] = e, new n } (M() || {}).Symbol, (M() || {}).Reflect; var p = t || function (e) { for (var t, n = 1, r = arguments.length; n < r; n++)for (var i in t = arguments[n]) c[a].call(t, i) && (e[i] = t[i]); return e }, g = function (e, t) { return (g = n.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t[a](n) && (e[n] = t[n]) })(e, t) }; function h(e, t) { function n() { this.constructor = e } typeof t !== o && null !== t && d("Class extends value " + t + " is not a constructor or null"), g(e, t), e[D] = null === t ? f(t) : (n[D] = t[D], new n) } var E, m = "constructor", v = "prototype", y = "function", I = "_dynInstFuncs", x = "_isDynProxy", C = "_dynClass", T = "_dynCls$", S = "_dynInstChk", b = S, k = "_dfOpts", A = "_unknown_", N = "__proto__", _ = "useBaseInst", P = "setInstFuncs", R = Object, L = R.getPrototypeOf, F = 0; function U(e, t) { return e && R[v].hasOwnProperty.call(e, t) } function q(e) { return e && (e === R[v] || e === Array[v]) } function V(e) { return q(e) || e === Function[v] } function H(e) { if (e) { if (L) return L(e); if (e = e[N] || e[v] || (e[m] ? e[m][v] : null)) return e } return null } function B(e, t) { var n = [], r = R.getOwnPropertyNames; if (r) n = r(e); else for (var i in e) "string" == typeof i && U(e, i) && n.push(i); if (n && 0 < n.length) for (var a = 0; a < n.length; a++)t(n[a]) } function O(e, t, n) { return t !== m && typeof e[t] === y && (n || U(e, t)) } function j(e) { throw new TypeError("DynamicProto: " + e) } function z(e, t) { for (var n = e.length - 1; 0 <= n; n--)if (e[n] === t) return 1 } function W(e, t) { return U(e, v) ? e.name || t || A : ((e || {})[m] || {}).name || t || A } function K(e, r, t, n) { U(e, v) || j("theClass is an invalid class definition."); var i = e[v]; !function (e) { if (L) for (var t = [], n = H(r); n && !V(n) && !z(t, n);) { if (n === e) return 1; t.push(n), n = H(n) } }(i) && j("[" + W(e) + "] is not in class hierarchy of [" + W(r) + "]"); var a = null; U(i, C) ? a = i[C] : (a = T + W(e, "_") + "$" + F, F++, i[C] = a); var o = K[k], s = !!o[_]; s && n && n[_] !== undefined && (s = !!n[_]); var c, u, l, d, f, p, e = (u = {}, B(c = r, function (e) { !u[e] && O(c, e, !1) && (u[e] = c[e]) }), u); t(r, function (e, t, n, a) { function r(e, t, n) { var r, i = t[n]; return i[x] && a && !1 !== (r = e[I] || {})[b] && (i = (r[t[C]] || {})[n] || i), function () { return i.apply(e, arguments) } } var i = {}; B(n, function (e) { i[e] = r(t, n, e) }); for (var o = H(e), s = []; o && !V(o) && !z(s, o);)B(o, function (e) { !i[e] && O(o, e, !L) && (i[e] = r(t, o, e)) }), s.push(o), o = H(o); return i }(i, r, e, s)), o = !!L && !!o[P], l = i, a = a, d = r, f = e, n = !1 !== (o = o && n ? !!n[P] : o), q(l) || (o = d[I] = d[I] || {}, p = o[a] = o[a] || {}, !1 !== o[b] && (o[b] = !!n), B(d, function (e) { var n, r, i; O(d, e, !1) && d[e] !== f[e] && (p[e] = d[e], delete d[e], U(l, e) && (!l[e] || l[e][x]) || (l[e] = (n = l, r = e, (i = function () { var e, t; return (function (e, t, n, r) { var i = null; if (e && U(n, C)) { var a = e[I] || {}; if ((i = (a[n[C]] || {})[t]) || j("Missing [" + t + "] " + y), !i[S] && !1 !== a[b]) { for (var o = !U(e, t), s = H(e), c = []; o && s && !V(s) && !z(c, s);) { var u = s[t]; if (u) { o = u === r; break } c.push(s), s = H(s) } try { o && (e[t] = i), i[S] = 1 } catch (l) { a[b] = !1 } } } return i }(this, r, n, i) || (typeof (t = (t = n[e = r]) === i ? H(n)[e] : t) !== y && j("[" + e + "] is not a " + y), t)).apply(this, arguments) })[x] = 1, i))) })) } K[k] = { setInstFuncs: !0, useBaseInst: !0 }, (Bi = E = E || {})[Bi.CRITICAL = 1] = "CRITICAL", Bi[Bi.WARNING = 2] = "WARNING"; var G = { BrowserDoesNotSupportLocalStorage: 0, BrowserCannotReadLocalStorage: 1, BrowserCannotReadSessionStorage: 2, BrowserCannotWriteLocalStorage: 3, BrowserCannotWriteSessionStorage: 4, BrowserFailedRemovalFromLocalStorage: 5, BrowserFailedRemovalFromSessionStorage: 6, CannotSendEmptyTelemetry: 7, ClientPerformanceMathError: 8, ErrorParsingAISessionCookie: 9, ErrorPVCalc: 10, ExceptionWhileLoggingError: 11, FailedAddingTelemetryToBuffer: 12, FailedMonitorAjaxAbort: 13, FailedMonitorAjaxDur: 14, FailedMonitorAjaxOpen: 15, FailedMonitorAjaxRSC: 16, FailedMonitorAjaxSend: 17, FailedMonitorAjaxGetCorrelationHeader: 18, FailedToAddHandlerForOnBeforeUnload: 19, FailedToSendQueuedTelemetry: 20, FailedToReportDataLoss: 21, FlushFailed: 22, MessageLimitPerPVExceeded: 23, MissingRequiredFieldSpecification: 24, NavigationTimingNotSupported: 25, OnError: 26, SessionRenewalDateIsZero: 27, SenderNotInitialized: 28, StartTrackEventFailed: 29, StopTrackEventFailed: 30, StartTrackFailed: 31, StopTrackFailed: 32, TelemetrySampledAndNotSent: 33, TrackEventFailed: 34, TrackExceptionFailed: 35, TrackMetricFailed: 36, TrackPVFailed: 37, TrackPVFailedCalc: 38, TrackTraceFailed: 39, TransmissionFailed: 40, FailedToSetStorageBuffer: 41, FailedToRestoreStorageBuffer: 42, InvalidBackendResponse: 43, FailedToFixDepricatedValues: 44, InvalidDurationValue: 45, TelemetryEnvelopeInvalid: 46, CreateEnvelopeError: 47, CannotSerializeObject: 48, CannotSerializeObjectNonSerializable: 49, CircularReferenceDetected: 50, ClearAuthContextFailed: 51, ExceptionTruncated: 52, IllegalCharsInName: 53, ItemNotInArray: 54, MaxAjaxPerPVExceeded: 55, MessageTruncated: 56, NameTooLong: 57, SampleRateOutOfRange: 58, SetAuthContextFailed: 59, SetAuthContextFailedAccountName: 60, StringValueTooLong: 61, StartCalledMoreThanOnce: 62, StopCalledWithoutStart: 63, TelemetryInitializerFailed: 64, TrackArgumentsNotSpecified: 65, UrlTooLong: 66, SessionStorageBufferFull: 67, CannotAccessCookie: 68, IdTooLong: 69, InvalidEvent: 70, FailedMonitorAjaxSetRequestHeader: 71, SendBrowserInfoOnUserInit: 72, PluginException: 73, NotificationException: 74, SnippetScriptLoadFailure: 99, InvalidInstrumentationKey: 100, CannotParseAiBlobValue: 101, InvalidContentBlob: 102, TrackPageActionEventFailed: 103 }, X = "on", J = "attachEvent", Y = "addEventListener", Z = "detachEvent", Q = "removeEventListener", $ = u; function ee(e) { return c.toString.call(e) } function te(e) { return e === undefined || typeof e === s } function ne(e) { return null === e || te(e) } function re(e) { return !ne(e) } function ie(e, t) { return e && l.call(e, t) } function ae(e) { return typeof e === w } function oe(e) { return typeof e === o } function se(e, t, n, r) { void 0 === r && (r = !1); var i = !1; if (!ne(e)) try { ne(e[Y]) ? ne(e[J]) || (e[J](X + t, n), i = !0) : (e[Y](t, n, r), i = !0) } catch (a) { } return i } function ce(e, t, n, r) { if (void 0 === r && (r = !1), !ne(e)) try { ne(e[Q]) ? ne(e[Z]) || e[Z](X + t, n) : e[Q](t, n, r) } catch (i) { } } function ue(e, t) { if (e) for (var n in e) l.call(e, n) && t.call(e, n, e[n]) } function le(e, t) { return !(!e || !t || !~e.indexOf(t)) } function de(e) { return "[object Date]" === ee(e) } function fe(e) { return "[object Array]" === ee(e) } function pe(e) { return "[object Error]" === ee(e) } function ge(e) { return "string" == typeof e } function he(e) { return "number" == typeof e } function me(e) { return "boolean" == typeof e } function ve(e) { if (de(e)) { var t = function (e) { return 1 === (e = "" + e).length ? "0" + e : e }; return e.getUTCFullYear() + "-" + t(1 + e.getUTCMonth()) + "-" + t(e.getUTCDate()) + "T" + t(e.getUTCHours()) + ":" + t(e.getUTCMinutes()) + ":" + t(e.getUTCSeconds()) + "." + ("" + (e.getUTCMilliseconds() / 1e3).toFixed(3)).slice(2, 5) + "Z" } } function ye(e, t, n) { for (var r = e.length, i = 0; i < r && !(i in e && -1 === t.call(n || e, e[i], i, e)); i++); } function Ie(e, t, n) { for (var r = e.length, i = Math.max(0 <= (n = n || 0) ? n : r - Math.abs(n), 0); i < r; i++)if (i in e && e[i] === t) return i; return -1 } function xe(e, t, n) { for (var r = e.length, i = n || e, a = Array(r), o = 0; o < r; o++)o in e && (a[o] = t.call(i, e[o], e)); return a } function Ce(e, t, n) { var r, i = e.length, a = 0; if (3 <= arguments.length) r = n; else { for (; a < i && !(a in e);)a++; r = e[a++] } for (; a < i;)a in e && (r = t(r, e[a], a, e)), a++; return r } function Te(e) { return "string" != typeof e ? e : e.replace(/^\s+|\s+$/g, "") } var we = !{ toString: null }.propertyIsEnumerable("toString"), Se = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"]; function be(e) { var t = typeof e; t === o || t === w && null !== e || d("objKeys called on non-object"); var n, r = []; for (n in e) e && l.call(e, n) && r.push(n); if (we) for (var i = Se.length, a = 0; a < i; a++)e && l.call(e, Se[a]) && r.push(Se[a]); return r } function Ee(e, t, n, r) { if ($) try { var i = { enumerable: !0, configurable: !0 }; return n && (i.get = n), r && (i.set = r), $(e, t, i), !0 } catch (a) { } return !1 } function ke() { var e = Date; return e.now ? e.now() : (new e).getTime() } function Ae(e) { return pe(e) ? e.name : "" } function Ne(e, t, n, r, i) { var a = n; return e && ((a = e[t]) === n || i && !i(a) || r && !r(n) || (e[t] = a = n)), a } function _e(e, t, n) { var r; return e ? !(r = e[t]) && ne(r) && (r = te(n) ? {} : n, e[t] = r) : r = te(n) ? {} : n, r } function Pe(e) { return !e } function Re(e) { return !!e } function Le(e) { throw Error(e) } function De(r, i, a) { if (r && i && r !== i && ae(r) && ae(i)) for (var e in i) !function (t) { var e, n; ge(t) && (oe(e = i[t]) ? a && !a(t, !0, i, r) || (r[t] = (n = t, function () { return i[n].apply(i, arguments) })) : a && !a(t, !1, i, r) || (ie(r, t) && delete r[t], Ee(r, t, function () { return i[t] }, function (e) { i[t] = e }) || (r[t] = e))) }(e); return r } function Me(e) { return e && n(t ? t({}, e) : e) } var Fe = "window", Ue = "document", qe = "navigator", Ve = "history", He = "location", Be = "performance", Oe = "JSON", je = "crypto", ze = "msCrypto", We = "msie", Ke = "trident/", Ge = null, Xe = null, Je = !1; function Ye(e) { var t = M(); return t && t[e] ? t[e] : e === Fe && Ze() ? window : null } function Ze() { return typeof window === w && window } function Qe() { return Ze() ? window : Ye(Fe) } function $e() { return typeof document === w && document } function et() { return $e() ? document : Ye(Ue) } function tt() { return typeof navigator === w && navigator ? navigator : Ye(qe) } function nt(e) { return e && Je && (e = Ye("__mockLocation")) ? e : typeof location === w && location ? location : Ye(He) } function rt() { return Ye(Be) } function it() { return typeof JSON === w && JSON || null !== Ye(Oe) } function at() { return it() ? JSON || Ye(Oe) : null } function ot() { var e = tt(); return !e || e.userAgent === Xe && null !== Ge || (e = ((Xe = e.userAgent) || "").toLowerCase(), Ge = le(e, We) || le(e, Ke)), Ge } function st(e) { var t; return le(e = ((e = (e = void 0 === e ? null : e) ? e : (t = tt() || {}) ? (t.userAgent || "").toLowerCase() : "") || "").toLowerCase(), We) ? parseInt(e.split(We)[1]) : le(e, Ke) && (e = parseInt(e.split(Ke)[1])) ? e + 4 : null } function ct(e) { var t = Object[D].toString.call(e), n = ""; return "[object Error]" === t ? n = "{ stack: '" + e.stack + "', message: '" + e.message + "', name: '" + e.name + "'" : it() && (n = at().stringify(e)), t + n } function ut(e) { return e ? '"' + e.replace(/\"/g, "") + '"' : "" } var lt = (dt.dataType = "MessageData", dt); function dt(e, t, n, r) { void 0 === n && (n = !1), this.messageId = e, this.message = (n ? "AI: " : "AI (Internal): ") + e, e = "", it() && (e = at().stringify(r)), e = (t ? " message:" + ut(t) : "") + (r ? " props:" + ut(e) : ""), this.message += e } function ft(e, t) { return (e || {}).logger || new pt(t) } var pt = function Ns(n) { this.identifier = "DiagnosticLogger", this.queue = []; var i = 0, o = {}; K(Ns, this, function (a) { function e(e, t) { return ne(e = n[e]) ? t : e } ne(n) && (n = {}), a.consoleLoggingLevel = function () { return e("loggingLevelConsole", 0) }, a.telemetryLoggingLevel = function () { return e("loggingLevelTelemetry", 1) }, a.maxInternalMessageLimit = function () { return e("maxMessageLimit", 25) }, a.enableDebugExceptions = function () { return e("enableDebugExceptions", !1) }, a.throwInternal = function (e, t, n, r, i) { if (n = new lt(t, n, i = void 0 !== i && i, r), a.enableDebugExceptions()) throw n; te(n) || !n || te(n.message) || (r = a.consoleLoggingLevel(), i ? (i = +n.messageId, !o[i] && r >= E.WARNING && (a.warnToConsole(n.message), o[i] = !0)) : r >= E.WARNING && a.warnToConsole(n.message), a.logInternalMessage(e, n)) }, a.warnToConsole = function (e) { var t, n = typeof console !== s ? console : Ye("console"); n && (t = "log", oe(n[t = n.warn ? "warn" : t]) && n[t](e)) }, a.resetInternalMessageCount = function () { i = 0, o = {} }, a.logInternalMessage = function (e, t) { var n, r; i >= a.maxInternalMessageLimit() || (n = !0, r = "AITR_" + t.messageId, o[r] ? n = !1 : o[r] = !0, n && (e <= a.telemetryLoggingLevel() && (a.queue.push(t), i++), i === a.maxInternalMessageLimit() && (t = new lt(G.MessageLimitPerPVExceeded, e = "Internal events throttle limit per PageView reached for this app.", !1), a.queue.push(t), a.warnToConsole(e)))) } }) }, gt = "ctx", ht = (mt.ParentContextKey = "parent", mt.ChildrenContextKey = "childEvts", mt); function mt(e, i, t) { var n, a = this, o = !1; a.start = ke(), a.name = e, a.isAsync = t, a.isChildEvt = function () { return !1 }, oe(i) && (o = Ee(a, "payload", function () { return !n && oe(i) && (n = i(), i = null), n })), a.getCtx = function (e) { return e ? (e === mt.ParentContextKey || e === mt.ChildrenContextKey ? a : a[gt] || {})[e] : null }, a.setCtx = function (e, t) { e && (e === mt.ParentContextKey ? (a[e] || (a.isChildEvt = function () { return !0 }), a[e] = t) : e === mt.ChildrenContextKey ? a[e] = t : (a[gt] = a[gt] || {})[e] = t) }, a.complete = function () { var e = 0, t = a.getCtx(mt.ChildrenContextKey); if (fe(t)) for (var n = 0; n < t.length; n++) { var r = t[n]; r && (e += r.time) } a.time = ke() - a.start, a.exTime = a.time - e, a.complete = function () { }, !o && oe(i) && (a.payload = i()) } } var vt = function _s(t) { this.ctx = {}, K(_s, this, function (n) { n.create = function (e, t, n) { return new ht(e, t, n) }, n.fire = function (e) { e && (e.complete(), t && t.perfEvent(e)) }, n.setCtx = function (e, t) { e && ((n[gt] = n[gt] || {})[e] = t) }, n.getCtx = function (e) { return (n[gt] || {})[e] } }) }, yt = "CoreUtils.doPerf"; function It(e, t, n, r, i) { if (e) { var a = e; if (a = a && oe(a.getPerfMgr) ? a.getPerfMgr() : a) { var o, s = void 0, e = a.getCtx(yt); try { if (s = a.create(t(), r, i)) return e && s.setCtx && (s.setCtx(ht.ParentContextKey, e), e.getCtx && e.setCtx && ((o = e.getCtx(ht.ChildrenContextKey)) || (o = [], e.setCtx(ht.ChildrenContextKey, o)), o.push(s))), a.setCtx(yt, s), n(s) } catch (c) { s && s.setCtx && s.setCtx("exception", c) } finally { s && a.fire(s), a.setCtx(yt, e) } } } return n() } var xt = function (i, t) { var a = this, o = null, s = oe(i.processTelemetry), c = oe(i.setNextPlugin); a._hasRun = !1, a.getPlugin = function () { return i }, a.getNext = function () { return o }, a.setNext = function (e) { o = e }, a.processTelemetry = function (n, r) { r = r || t; var e = i ? i.identifier : "TelemetryPluginChain"; It(r ? r.core() : null, function () { return e + ":processTelemetry" }, function () { if (i && s) { a._hasRun = !0; try { r.setNext(o), c && i.setNextPlugin(o), o && (o._hasRun = !1), i.processTelemetry(n, r) } catch (t) { var e = o && o._hasRun; o && e || r.diagLog().throwInternal(E.CRITICAL, G.PluginException, "Plugin [" + i.identifier + "] failed during processTelemetry - " + t), o && !e && o.processTelemetry(n, r) } } else o && (a._hasRun = !0, o.processTelemetry(n, r)) }, function () { return { item: n } }, !n.sync) } }; function Ct(e, t) { var n = []; if (e && 0 < e.length) for (var r = null, i = 0; i < e.length; i++) { var a = e[i]; a && oe(a.processTelemetry) && (a = new xt(a, t), n.push(a), r && r.setNext(a), r = a) } return 0 < n.length ? n[0] : null } var Tt = function Ps(e, i, n, t) { var r, a, o, s, c = this, u = null; null !== t && (e && oe(e.getPlugin) ? u = function (e, t, n) { var r = [], i = !n; if (e) for (; e;) { var a = e.getPlugin(); !i && a !== n || (i = !0, r.push(a)), e = e.getNext() } return i || r.push(n), Ct(r, t) }(e, c, t || e.getPlugin()) : t ? (r = c, o = e, s = !1, (a = t) && e && (o = [], ye(e, function (e) { !s && e !== a || (s = !0, o.push(e)) })), a && !s && (o = o || []).push(a), u = Ct(o, r)) : te(t) && (u = Ct(e, c))), c.core = function () { return n }, c.diagLog = function () { return ft(n, i) }, c.getCfg = function () { return i }, c.getExtCfg = function (e, t) { var n, r; return void 0 === t && (t = {}), !i || (r = i.extensionConfig) && e && (n = r[e]), n || t }, c.getConfig = function (e, t, n) { var r; return void 0 === n && (n = !1), (e = c.getExtCfg(e, null)) && !ne(e[t]) ? r = e[t] : i && !ne(i[t]) && (r = i[t]), ne(r) ? n : r }, c.hasNext = function () { return null != u }, c.getNext = function () { return u }, c.setNext = function (e) { u = e }, c.processNext = function (e) { var t = u; t && (u = t.getNext(), t.processTelemetry(e, c)) }, c.createNew = function (e, t) { return new Ps((e = void 0 === e ? null : e) || u, i, n, t) } }, wt = "extensionConfig", St = "getPlugin", bt = (Et.prototype.initialize = function (e, t, n, r) { this._baseTelInit(e, t, n, r) }, Et); function Et() { var a = this, o = !1, s = null, c = null; a.core = null, a.diagLog = function (e) { return a._getTelCtx(e).diagLog() }, a.isInitialized = function () { return o }, a.setInitialized = function (e) { o = e }, a.setNextPlugin = function (e) { c = e }, a.processNext = function (e, t) { t ? t.processNext(e) : c && oe(c.processTelemetry) && c.processTelemetry(e, null) }, a._getTelCtx = function (e) { var t = e = void 0 === e ? null : e; return t || (e = s || new Tt(null, {}, a.core), t = c && c[St] ? e.createNew(null, c[St]) : e.createNew(null, c)), t }, a._baseTelInit = function (e, t, n, r) { e && Ne(e, wt, [], null, ne), !r && t && (r = t.getProcessTelContext().getNext()); var i = c; c && c[St] && (i = c[St]()), a.core = t, s = new Tt(r, e, t, i), o = !0 } } var kt = "processTelemetry", At = "priority", Nt = "setNextPlugin", _t = "isInitialized"; function Pt(t, n) { for (var e = [], r = null, i = t.getNext(); i;) { var a = i.getPlugin(); a && (r && oe(r[Nt]) && oe(a[kt]) && r[Nt](a), oe(a[_t]) && a[_t]() || e.push(a), r = a, i = i.getNext()) } ye(e, function (e) { e.initialize(t.getCfg(), t.core(), n, t.getNext()) }) } function Rt(e) { return e.sort(function (e, t) { var n = 0, r = oe(t[kt]); return oe(e[kt]) ? n = r ? e[At] - t[At] : 1 : r && (n = -1), n }) } var Lt, Dt = 500, Mt = "Channel has invalid priority", Ft = (h(Ut, Lt = bt), Ut._staticInit = (Ee(ha = Ut.prototype, "ChannelControls", ha.getChannelControls), void Ee(ha, "channelQueue", ha.getChannelControls)), Ut); function Ut() { var c, r = Lt.call(this) || this; function u(e) { e && 0 < e.length && (ye(e = e.sort(function (e, t) { return e.priority - t.priority }), function (e) { e.priority < Dt && Le(Mt + e.identifier) }), c.push(e)) } return r.identifier = "ChannelControllerPlugin", r.priority = Dt, K(Ut, r, function (o, s) { o.setNextPlugin = function (e) { }, o.processTelemetry = function (t, n) { c && ye(c, function (e) { 0 < e.length && r._getTelCtx(n).createNew(e).processNext(t) }) }, o.getChannelControls = function () { return c }, o.initialize = function (t, n, r) { var e, i, a; o.isInitialized() || (s.initialize(t, n, r), e = (t || {}).channels, i = r, c = [], e && ye(e, u), i && (a = [], ye(i, function (e) { e.priority > Dt && a.push(e) }), u(a)), ye(c, function (e) { return Pt(new Tt(e, t, n), r) })) } }), r } var qt = "toGMTString", Vt = "toUTCString", Ht = "cookie", Bt = "expires", Ot = "enabled", jt = "isCookieUseDisabled", zt = "disableCookiesUsage", Wt = "_ckMgr", Kt = "", Gt = null, Xt = null, Jt = null, Yt = et(), Zt = {}, Qt = {}; function $t(e, t) { var n = nn[Wt] || Qt[Wt]; return n || (n = nn[Wt] = nn(e, t), Qt[Wt] = n), n } function en(e) { return !e || e.isEnabled() } function tn(e, t) { var n; return e ? n = e.getCookieMgr() : t && (n = (t || {}).cookieCfg[Wt] || nn(t)), n || $t(t, (e || {}).logger) } function nn(e, r) { var t, n, c = (Ne(n = (t = e || Qt).cookieCfg = t.cookieCfg || {}, "domain", t.cookieDomain, re, ne), Ne(n, "path", t.cookiePath || "/", null, ne), ne(n[Ot]) && (e = void 0, te(t[jt]) || (e = !t[jt]), te(t[zt]) || (e = !t[zt]), n[Ot] = e), n), u = c.path || "/", l = c.domain, i = !1 !== c[Ot], d = { isEnabled: function () { var e = i && rn(r), t = Qt[Wt]; return e && t && d !== t ? en(t) : e }, setEnabled: function (e) { i = !1 !== e }, set: function (e, t, n, r, i) { var a, o, s; en(d) && (a = {}, -1 != (s = (o = Te(t || Kt)).indexOf(";")) && (o = Te(t.substring(0, s)), a = an(t.substring(1 + s))), Ne(a, "domain", r || l, Re, te), ne(n) || (t = ot(), !te(a[Bt]) || 0 < (s = ke() + 1e3 * n) && ((r = new Date).setTime(s), Ne(a, Bt, on(r, t ? qt : Vt) || on(r, t ? qt : Vt) || Kt, Re)), t || Ne(a, "max-age", Kt + n, null, te)), (n = nt()) && "https:" === n.protocol && (Ne(a, "secure", null, null, te), (Xt = null === Xt ? !un((tt() || {}).userAgent) : Xt) && Ne(a, "SameSite", "None", null, te)), Ne(a, "path", i || u, null, te), (c.setCookie || cn)(e, sn(o, a))) }, get: function (e) { var t = Kt; return en(d) ? (c.getCookie || function (e) { var t, n = Kt; return Yt && (t = Yt[Ht] || Kt, Jt !== t && (Zt = an(t), Jt = t), n = Te(Zt[e] || Kt)), n })(e) : t }, del: function (e, t) { en(d) && d.purge(e, t) }, purge: function (e, t) { var n; rn(r) && ((n = {}).path = t || "/", n[Bt] = "Thu, 01 Jan 1970 00:00:01 GMT", ot() || (n["max-age"] = "0"), (c.delCookie || cn)(e, sn(Kt, n))) } }; return d[Wt] = d } function rn(e) { if (null === Gt) { Gt = !1; try { Gt = (Yt || {})[Ht] !== undefined } catch (t) { e && e.throwInternal(E.WARNING, G.CannotAccessCookie, "Cannot access document.cookie - " + Ae(t), { exception: ct(t) }) } } return Gt } function an(e) { var n = {}; return e && e.length && ye(Te(e).split(";"), function (e) { var t; (e = Te(e || Kt)) && (-1 == (t = e.indexOf("=")) ? n[e] = null : n[Te(e.substring(0, t))] = Te(e.substring(1 + t))) }), n } function on(e, t) { return oe(e[t]) ? e[t]() : null } function sn(e, t) { var n = e || Kt; return ue(t, function (e, t) { n += "; " + e + (ne(t) ? Kt : "=" + t) }), n } function cn(e, t) { Yt && (Yt[Ht] = e + "=" + t) } function un(e) { return !(!ge(e) || !le(e, "CPU iPhone OS 12") && !le(e, "iPad; CPU OS 12") && !(le(e, "Macintosh; Intel Mac OS X 10_14") && le(e, "Version/") && le(e, "Safari")) && (!le(e, "Macintosh; Intel Mac OS X 10_14") || !function (e, t) { if (e) { var n = e.length; if (e === t) return 1; if (40 <= n) { for (var r = n - 1, i = 39; 0 <= i; i--) { if (e[r] != t[i]) return; r-- } return 1 } } }(e, "AppleWebKit/605.1.15 (KHTML, like Gecko)")) && !le(e, "Chrome/5") && !le(e, "Chrome/6") && (!le(e, "UnrealEngine") || le(e, "Chrome")) && !le(e, "UCBrowser/12") && !le(e, "UCBrowser/11")) } var ln, dn = "_notificationManager", fn = function Rs(e) { this.listeners = []; var t = !!(e || {}).perfEvtsSendAll; K(Rs, this, function (i) { i.addNotificationListener = function (e) { i.listeners.push(e) }, i.removeNotificationListener = function (e) { for (var t = Ie(i.listeners, e); -1 < t;)i.listeners.splice(t, 1), t = Ie(i.listeners, e) }, i.eventsSent = function (t) { ye(i.listeners, function (e) { e && e.eventsSent && setTimeout(function () { return e.eventsSent(t) }, 0) }) }, i.eventsDiscarded = function (t, n) { ye(i.listeners, function (e) { e && e.eventsDiscarded && setTimeout(function () { return e.eventsDiscarded(t, n) }, 0) }) }, i.eventsSendRequest = function (n, r) { ye(i.listeners, function (e) { if (e && e.eventsSendRequest) if (r) setTimeout(function () { return e.eventsSendRequest(n, r) }, 0); else try { e.eventsSendRequest(n, r) } catch (t) { } }) }, i.perfEvent = function (n) { n && (!t && n.isChildEvt() || ye(i.listeners, function (e) { if (e && e.perfEvent) if (n.isAsync) setTimeout(function () { return e.perfEvent(n) }, 0); else try { e.perfEvent(n) } catch (t) { } })) } }) }, pn = (h(gn, ln = function Ls() { var t, s, c, n, r, u = !1; K(Ls, this, function (o) { o._extensions = [], s = new Ft, o.logger = f({ throwInternal: function (e, t, n, r, i) { }, warnToConsole: function (e) { }, resetInternalMessageCount: function () { } }), t = [], o.isInitialized = function () { return u }, o.initialize = function (e, t, r, n) { o.isInitialized() && Le("Core should not be initialized more than once"), e && !ne(e.instrumentationKey) || Le("Please provide instrumentation key"), c = n, o[dn] = n, o.config = e || {}, e.extensions = ne(e.extensions) ? [] : e.extensions, _e(e, wt).NotificationManager = n, r && (o.logger = r), (n = []).push.apply(n, t.concat(e.extensions)); var n = Rt(n), i = [], a = {}; ye(n, function (e) { (ne(e) || ne(e.initialize)) && Le("Extensions must provide callback to initialize"); var t = e.priority, n = e.identifier; e && t && (ne(a[t]) ? a[t] = n : r.warnToConsole("Two extensions have same priority #" + t + " - " + a[t] + ", " + n)), (!t || t < s.priority) && i.push(e) }), n.push(s), i.push(s), n = Rt(n), o._extensions = n, Pt(new Tt([s], e, o), n), Pt(new Tt(i, e, o), n), o._extensions = i, 0 === o.getTransmissionControls().length && Le("No channels available"), u = !0, o.releaseQueue() }, o.getTransmissionControls = function () { return s.getChannelControls() }, o.track = function (e) { Ne(e, "iKey", o.config.instrumentationKey, null, Pe), Ne(e, "time", ve(new Date), null, Pe), Ne(e, "ver", "4.0", null, ne), o.isInitialized() ? o.getProcessTelContext().processNext(e) : t.push(e) }, o.getProcessTelContext = function () { var e = o._extensions, t = e; return e && 0 !== e.length || (t = [s]), new Tt(t, o.config, o) }, o.getNotifyMgr = function () { return c || (c = f({ addNotificationListener: function (e) { }, removeNotificationListener: function (e) { }, eventsSent: function (e) { }, eventsDiscarded: function (e, t) { }, eventsSendRequest: function (e, t) { } }), o[dn] = c), c }, o.getCookieMgr = function () { return r = r || nn(o.config, o.logger) }, o.setCookieMgr = function (e) { r = e }, o.getPerfMgr = function () { return n || o.config && o.config.enablePerfMgr && (n = new vt(o.getNotifyMgr())), n }, o.setPerfMgr = function (e) { n = e }, o.eventCnt = function () { return t.length }, o.releaseQueue = function () { 0 < t.length && (ye(t, function (e) { o.getProcessTelContext().processNext(e) }), t = []) } }) }), gn); function gn() { var e = ln.call(this) || this; return K(gn, e, function (n, i) { function t(e) { var t = n.getNotifyMgr(); t && t.eventsDiscarded([e], r.InvalidEvent) } n.initialize = function (e, t, n, r) { i.initialize(e, t, n || new pt(e), r || new fn(e)) }, n.track = function (e) { It(n.getPerfMgr(), function () { return "AppInsightsCore:track" }, function () { null === e && (t(e), Le("Invalid telemetry item")), function () { if (ne(e.name)) throw t(e), Error("telemetry name required") }(), i.track(e) }, function () { return { item: e } }, !e.sync) }, n.addNotificationListener = function (e) { var t = n.getNotifyMgr(); t && t.addNotificationListener(e) }, n.removeNotificationListener = function (e) { var t = n.getNotifyMgr(); t && t.removeNotificationListener(e) }, n.pollInternalLogs = function (t) { var e = n.config.diagnosticLogInterval; return setInterval(function () { var e = n.logger ? n.logger.queue : []; ye(e, function (e) { e = { name: t || "InternalMessageId: " + e.messageId, iKey: n.config.instrumentationKey, time: ve(new Date), baseType: lt.dataType, baseData: { message: e.message } }, n.track(e) }), e.length = 0 }, e = e && 0 < e ? e : 1e4) } }), e } var hn = 4294967296, mn = 4294967295, vn = !1, yn = 123456789, In = 987654321; function xn(e) { e < 0 && (e >>>= 0), yn = 123456789 + e & mn, In = 987654321 - e & mn, vn = !0 } function Cn() { try { var e = 2147483647 & ke(); xn((Math.random() * hn ^ e) + e) } catch (t) { } } function Tn(e) { return 0 < e ? Math.floor(wn() / mn * (e + 1)) >>> 0 : 0 } function wn(e) { var t = (t = Ye(je) || Ye(ze)) && t.getRandomValues ? t.getRandomValues(new Uint32Array(1))[0] & mn : ot() ? (vn || Cn(), Sn() & mn) : Math.floor(hn * Math.random() | 0); return e || (t >>>= 0), t } function Sn(e) { var t = ((In = 36969 * (65535 & In) + (In >> 16) & mn) << 16) + (65535 & (yn = 18e3 * (65535 & yn) + (yn >> 16) & mn)) >>> 0 & mn | 0; return e || (t >>>= 0), t } var bn, En = null; function kn(e, t) { var n = !1, r = Qe(); return r && (n = se(r, e, t), n = se(r.body, e, t) || n), (r = et()) && Rn.Attach(r, e, t) || n } function An(e) { void 0 === e && (e = 22); for (var t = wn() >>> 0, n = 0, r = ""; r.length < e;)r += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[0 | 63 & t] || "", t >>>= 6, 5 == ++n && (t = (wn() << 2 & 4294967295 | 3 & t) >>> 0, n = 0); return r } function Nn() { for (var e, t = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"], n = "", r = 0; r < 4; r++)n += t[15 & (e = wn())] + t[e >> 4 & 15] + t[e >> 8 & 15] + t[e >> 12 & 15] + t[e >> 16 & 15] + t[e >> 20 & 15] + t[e >> 24 & 15] + t[e >> 28 & 15]; var i = t[8 + (3 & wn()) | 0]; return n.substr(0, 8) + n.substr(9, 4) + "4" + n.substr(13, 3) + i + n.substr(16, 3) + n.substr(19, 12) } var _n = { _canUseCookies: undefined, isTypeof: function (e, t) { return typeof e === t }, isUndefined: te, isNullOrUndefined: ne, hasOwnProperty: ie, isFunction: oe, isObject: ae, isDate: de, isArray: fe, isError: pe, isString: ge, isNumber: he, isBoolean: me, toISOString: ve, arrForEach: ye, arrIndexOf: Ie, arrMap: xe, arrReduce: Ce, strTrim: Te, objCreate: f, objKeys: be, objDefineAccessors: Ee, addEventHandler: kn, dateNow: ke, isIE: ot, disableCookies: Dn, newGuid: function () { return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Pn, function (e) { var t = 0 | Tn(15); return ("x" === e ? t : 3 & t | 8).toString(16) }) }, perfNow: function () { var e = rt(); return e && e.now ? e.now() : ke() }, newId: An, randomValue: Tn, random32: wn, mwcRandomSeed: function (e) { e ? xn(e) : Cn() }, mwcRandom32: Sn, generateW3CId: Nn }, Pn = /[xy]/g, Rn = { Attach: se, AttachEvent: se, Detach: ce, DetachEvent: ce }; function Ln(e, t) { return e = $t(e, t), t = _n._canUseCookies, null === En && (En = [], bn = t, Ee(_n, "_canUseCookies", function () { return bn }, function (t) { bn = t, ye(En, function (e) { e.setEnabled(t) }) })), -1 === Ie(En, e) && En.push(e), me(t) && e.setEnabled(t), me(bn) && e.setEnabled(bn), e } function Dn() { Ln().setEnabled(!1) } var Mn = "_aiHooks", Fn = ["req", "rsp", "hkErr", "fnErr"], Un = "__proto__", qn = "constructor"; function Vn(e, t) { if (e) for (var n = 0; n < e.length && !t(e[n], n); n++); } function Hn(e, o, s, c, u) { 0 <= u && u <= 2 && Vn(e, function (e, t) { var n = e.cbks; if (e = n[Fn[u]]) { o.ctx = function () { return c[t] = c[t] || {} }; try { e.apply(o.inst, s) } catch (i) { e = o.err; try { var r = n[Fn[2]]; r && (o.err = i, r.apply(o.inst, s)) } catch (a) { } finally { o.err = e } } } }) } function Bn(c) { return function () { var n = arguments, e = c.h, r = { name: c.n, inst: this, ctx: null, set: function (e, t) { (n = a([], n))[e] = t, i = a([r], n) } }, t = [], i = a([r], n); function a(t, e) { return Vn(e, function (e) { t.push(e) }), t } Hn(e, r, i, t, 0); var o = c.f; try { r.rslt = o.apply(this, n) } catch (s) { throw r.err = s, Hn(e, r, i, t, 3), s } return Hn(e, r, i, t, 1), r.rslt } } var On = Object.getPrototypeOf; function jn(e, t, n, r) { if (void 0 === r && (r = !0), e && t && n && (e = function a(e, t, n) { var r = null; return e && (ie(e, t) ? r = e : n && (r = a(function (e) { if (e) { if (On) return On(e); if (e = e[Un] || e[D] || e[qn]) return e } return null }(e), t, !1))), r }(e, t, r)) && typeof (r = e[t]) === o) { var i = r[Mn]; return i || ((r = Bn(i = { i: 0, n: t, f: r, h: [] }))[Mn] = i, e[t] = r), n = { id: i.i, cbks: n, rm: function () { var n = this.id; Vn(i.h, function (e, t) { return e.id === n && (i.h.splice(t, 1), 1) }) } }, i.i++, i.h.push(n), n } return null } var zn = { requestContextHeader: "Request-Context", requestContextTargetKey: "appId", requestContextAppIdFormat: "appId=cid-v1:", requestIdHeader: "Request-Id", traceParentHeader: "traceparent", traceStateHeader: "tracestate", sdkContextHeader: "Sdk-Context", sdkContextHeaderAppIdRequest: "appId", requestContextHeaderLowerCase: "request-context" }; function Wn(e, t, n) { var r = t.length, i = Kn(e, t); if (i.length !== r) { for (var a = 0, o = i; n[o] !== undefined;)a++, o = i.substring(0, 147) + tr(a); i = o } return i } function Kn(e, t) { var n; return t && 150 < (t = Te(t.toString())).length && (n = t.substring(0, 150), e.throwInternal(E.WARNING, G.NameTooLong, "name is too long.  It has been truncated to 150 characters.", { name: t }, !0)), n || t } function Gn(e, t, n) { var r; return void 0 === n && (n = 1024), t && (n = n || 1024, (t = Te(t)).toString().length > n && (r = t.toString().substring(0, n), e.throwInternal(E.WARNING, G.StringValueTooLong, "string value is too long. It has been truncated to " + n + " characters.", { value: t }, !0))), r || t } function Xn(e, t) { return er(e, t, 2048, G.UrlTooLong) } function Jn(e, t) { var n; return t && 32768 < t.length && (n = t.substring(0, 32768), e.throwInternal(E.WARNING, G.MessageTruncated, "message is too long, it has been truncated to 32768 characters.", { message: t }, !0)), n || t } function Yn(e, t) { var n, r; return !t || 32768 < (r = "" + t).length && (n = r.substring(0, 32768), e.throwInternal(E.WARNING, G.ExceptionTruncated, "exception is too long, it has been truncated to 32768 characters.", { exception: t }, !0)), n || t } function Zn(r, e) { var i; return e && (i = {}, ue(e, function (e, t) { if (ae(t) && it()) try { t = at().stringify(t) } catch (n) { r.throwInternal(E.WARNING, G.CannotSerializeObjectNonSerializable, "custom property is not valid", { exception: n }, !0) } t = Gn(r, t, 8192), e = Wn(r, e, i), i[e] = t }), e = i), e } function Qn(n, e) { var r; return e && (r = {}, ue(e, function (e, t) { e = Wn(n, e, r), r[e] = t }), e = r), e } function $n(e, t) { return t && er(e, t, 128, G.IdTooLong).toString() } function er(e, t, n, r) { var i; return t && (t = Te(t)).length > n && (i = t.substring(0, n), e.throwInternal(E.WARNING, r, "input is too long, it has been truncated to " + n + " characters.", { data: t }, !0)), i || t } function tr(e) { return (e = "00" + e).substr(e.length - 3) } var nr = { MAX_NAME_LENGTH: 150, MAX_ID_LENGTH: 128, MAX_PROPERTY_LENGTH: 8192, MAX_STRING_LENGTH: 1024, MAX_URL_LENGTH: 2048, MAX_MESSAGE_LENGTH: 32768, MAX_EXCEPTION_LENGTH: 32768, sanitizeKeyAndAddUniqueness: Wn, sanitizeKey: Kn, sanitizeString: Gn, sanitizeUrl: Xn, sanitizeMessage: Jn, sanitizeException: Yn, sanitizeProperties: Zn, sanitizeMeasurements: Qn, sanitizeId: $n, sanitizeInput: er, padNumber: tr, trim: Te }; function rr(e) { var t, n = null; return oe(Event) ? n = new Event(e) : (t = et()) && t.createEvent && (n = t.createEvent("Event")).initEvent(e, !0, !0), n } function ir(e, t) { return void 0 === t && (t = !1), e === undefined || null === e ? t : "true" == e.toString().toLowerCase() } function ar(e) { var t = "" + Math.floor((e = Math.round(e = isNaN(e) || e < 0 ? 0 : e)) / 1e3) % 60, n = "" + Math.floor(e / 6e4) % 60, r = "" + Math.floor(e / 36e5) % 24, i = Math.floor(e / 864e5), e = 1 === (e = "" + e % 1e3).length ? "00" + e : 2 === e.length ? "0" + e : e, t = t.length < 2 ? "0" + t : t, n = n.length < 2 ? "0" + n : n; return (0 < i ? i + "." : "") + (r = r.length < 2 ? "0" + r : r) + ":" + n + ":" + t + "." + e } function or() { var e = tt(); return "sendBeacon" in e && e.sendBeacon } function sr(e, t) { var n = null; return ye(e, function (e) { if (e.identifier === t) return n = e, -1 }), n } function cr(e, t, n, r, i) { return !i && ge(e) && ("Script error." === e || "Script error" === e) } var ur, lr, dr = "Microsoft_ApplicationInsights_BypassAjaxInstrumentation", fr = "sampleRate", pr = "ProcessLegacy", gr = "http.method", hr = "https://dc.services.visualstudio.com", mr = "not_specified"; (sa = ur = ur || {})[sa.LocalStorage = 0] = "LocalStorage", sa[sa.SessionStorage = 1] = "SessionStorage", (fa = lr = lr || {})[fa.AI = 0] = "AI", fa[fa.AI_AND_W3C = 1] = "AI_AND_W3C", fa[fa.W3C = 2] = "W3C"; var vr = undefined, yr = undefined; function Ir() { return wr() ? xr(ur.LocalStorage) : null } function xr(e) { try { if (ne(M())) return null; var t = new Date, n = Ye(e === ur.LocalStorage ? "localStorage" : "sessionStorage"); n.setItem(t.toString(), t.toString()); var r = n.getItem(t.toString()) !== t.toString(); if (n.removeItem(t.toString()), !r) return n } catch (i) { } return null } function Cr() { return kr() ? xr(ur.SessionStorage) : null } function Tr() { yr = vr = !1 } function wr() { return vr = vr === undefined ? !!xr(ur.LocalStorage) : vr } function Sr(e, t) { var n = Ir(); if (null !== n) try { return n.getItem(t) } catch (r) { vr = !1, e.throwInternal(E.WARNING, G.BrowserCannotReadLocalStorage, "Browser failed read of local storage. " + Ae(r), { exception: ct(r) }) } return null } function br(e, t, n) { var r = Ir(); if (null !== r) try { return r.setItem(t, n), !0 } catch (i) { vr = !1, e.throwInternal(E.WARNING, G.BrowserCannotWriteLocalStorage, "Browser failed write to local storage. " + Ae(i), { exception: ct(i) }) } return !1 } function Er(e, t) { var n = Ir(); if (null !== n) try { return n.removeItem(t), !0 } catch (r) { vr = !1, e.throwInternal(E.WARNING, G.BrowserFailedRemovalFromLocalStorage, "Browser failed removal of local storage item. " + Ae(r), { exception: ct(r) }) } return !1 } function kr() { return yr = yr === undefined ? !!xr(ur.SessionStorage) : yr } function Ar(e, t) { var n = Cr(); if (null !== n) try { return n.getItem(t) } catch (r) { yr = !1, e.throwInternal(E.WARNING, G.BrowserCannotReadSessionStorage, "Browser failed read of session storage. " + Ae(r), { exception: ct(r) }) } return null } function Nr(e, t, n) { var r = Cr(); if (null !== r) try { return r.setItem(t, n), !0 } catch (i) { yr = !1, e.throwInternal(E.WARNING, G.BrowserCannotWriteSessionStorage, "Browser failed write to session storage. " + Ae(i), { exception: ct(i) }) } return !1 } function _r(e, t) { var n = Cr(); if (null !== n) try { return n.removeItem(t), !0 } catch (r) { yr = !1, e.throwInternal(E.WARNING, G.BrowserFailedRemovalFromSessionStorage, "Browser failed removal of session storage item. " + Ae(r), { exception: ct(r) }) } return !1 } var Pr = et() || {}, Rr = 0, Lr = [null, null, null, null, null]; function Dr(e) { var t = Rr, n = Lr, r = n[t]; return Pr.createElement ? n[t] || (r = n[t] = Pr.createElement("a")) : r = { host: Ur(e, !0) }, r.href = e, ++t >= n.length && (t = 0), Rr = t, r } function Mr(e) { return (e = Dr(e)) ? e.href : void 0 } function Fr(e, t) { return e ? e.toUpperCase() + " " + t : t } function Ur(e, t) { return (e = qr(e, t)) && null != (t = e.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i)) && 3 < t.length && ge(t[2]) && 0 < t[2].length ? t[2] + (t[3] || "") : e } function qr(e, t) { var n = null; return !e || null != (e = e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i)) && 2 < e.length && ge(e[2]) && 0 < e[2].length && (n = e[2] || "", t && 2 < e.length && (t = (e[1] || "").toLowerCase(), e = e[3] || "", n += e = "http" == t && ":80" === e || "https" == t && ":443" === e ? "" : e)), n } var Vr = ["https://dc.services.visualstudio.com/v2/track", "https://breeze.aimon.applicationinsights.io/v2/track", "https://dc-int.services.visualstudio.com/v2/track"]; function Hr(e) { return !!~Vr.indexOf(e.toLowerCase()) } var Br = { NotSpecified: mr, createDomEvent: rr, disableStorage: Tr, isInternalApplicationInsightsEndpoint: Hr, canUseLocalStorage: wr, getStorage: Sr, setStorage: br, removeStorage: Er, canUseSessionStorage: kr, getSessionStorageKeys: function () { var t = []; return kr() && ue(Ye("sessionStorage"), function (e) { t.push(e) }), t }, getSessionStorage: Ar, setSessionStorage: Nr, removeSessionStorage: _r, disableCookies: Dn, canUseCookies: function (e) { return Ln(null, e).isEnabled() }, disallowsSameSiteNone: un, setCookie: function (e, t, n, r) { Ln(null, e).set(t, n, null, r) }, stringToBoolOrDefault: ir, getCookie: function (e, t) { return Ln(null, e).get(t) }, deleteCookie: function (e, t) { return Ln(null, e).del(t) }, trim: Te, newId: An, random32: function () { return wn(!0) }, generateW3CId: Nn, isArray: fe, isError: pe, isDate: de, toISOStringForIE8: ve, getIEVersion: st, msToTimeSpan: ar, isCrossOriginError: cr, dump: ct, getExceptionName: Ae, addEventHandler: se, IsBeaconApiSupported: or, getExtension: sr }, Or = { parseUrl: Dr, getAbsoluteUrl: Mr, getPathName: function (e) { return (e = Dr(e)) ? e.pathname : void 0 }, getCompleteUrl: Fr, parseHost: Ur, parseFullHost: qr }, jr = { correlationIdPrefix: "cid-v1:", canIncludeCorrelationHeader: function (e, t, n) { if (!t || e && e.disableCorrelationHeaders) return !1; if (e && e.correlationHeaderExcludePatterns) for (var r = 0; r < e.correlationHeaderExcludePatterns.length; r++)if (e.correlationHeaderExcludePatterns[r].test(t)) return !1; var i, a = Dr(t).host.toLowerCase(); if (a && (~a.indexOf(":443") || ~a.indexOf(":80")) && (a = (qr(t, !0) || "").toLowerCase()), !(e && e.enableCorsCorrelation || a === n)) return !1; if ((n = e && e.correlationHeaderDomains) && (ye(n, function (e) { e = RegExp(e.toLowerCase().replace(/\./g, ".").replace(/\*/g, ".*")), i = i || e.test(a) }), !i)) return !1; var o = e && e.correlationHeaderExcludedDomains; if (!o || 0 === o.length) return !0; for (r = 0; r < o.length; r++)if (RegExp(o[r].toLowerCase().replace(/\./g, ".").replace(/\*/g, ".*")).test(a)) return !1; return a && 0 < a.length }, getCorrelationContext: function (e) { if ((e = e && jr.getCorrelationContextValue(e, zn.requestContextTargetKey)) && e !== jr.correlationIdPrefix) return e }, getCorrelationContextValue: function (e, t) { if (e) for (var n = e.split(","), r = 0; r < n.length; ++r) { var i = n[r].split("="); if (2 === i.length && i[0] === t) return i[1] } } }; function zr() { var e = rt(); return e && e.now && e.timing && 0 < (e = e.now() + e.timing.navigationStart) ? e : ke() } function Wr(e, t) { return 0 === e || 0 === t || ne(e) || ne(t) ? null : t - e } var Kr = { Now: zr, GetDuration: Wr }, Gr = ";", Xr = "="; function Jr(e) { if (!e) return {}; var t = Ce(e.split(Gr), function (e, t) { var n = t.split(Xr); return 2 === n.length && (t = n[0].toLowerCase(), n = n[1], e[t] = n), e }, {}); return 0 < be(t).length && (t.endpointsuffix && (e = t.location ? t.location + "." : "", t.ingestionendpoint = t.ingestionendpoint || "https://" + e + "dc." + t.endpointsuffix), t.ingestionendpoint = t.ingestionendpoint || hr), t } var Yr, Zr = { parse: Jr }, Qr = function () { }, $r = (h(ei, Yr = Qr), ei); function ei() { return Yr.call(this) || this } var ti, ni = (h(ri, ti = function () { this.ver = 1, this.sampleRate = 100, this.tags = {} }), ri); function ri(e, t, n) { var r = ti.call(this) || this; return r.name = Gn(e, n) || mr, r.data = t, r.time = ve(new Date), r.aiDataContract = { time: 1, iKey: 1, name: 1, sampleRate: function () { return 100 === r.sampleRate ? 4 : 1 }, tags: 1, data: 1 }, r } var ii, ai = (h(oi, ii = ga = function () { this.ver = 2, this.properties = {}, this.measurements = {} }), oi.envelopeType = "Microsoft.ApplicationInsights.{0}.Event", oi.dataType = "EventData", oi); function oi(e, t, n, r) { var i = ii.call(this) || this; return i.aiDataContract = { ver: 1, name: 1, properties: 0, measurements: 0 }, i.name = Gn(e, t) || mr, i.properties = Zn(e, n), i.measurements = Qn(e, r), i } var si = function () { }, ci = function () { this.hasFullStack = !0, this.parsedStack = [] }, ui = "<no_method>", li = "error", di = "stack", fi = "stackDetails", pi = "errorSrc", gi = "message", hi = "description"; function mi(e, t) { var n = e; return n && !ge(n) && (JSON && JSON.stringify ? (n = JSON.stringify(e), !t || n && "{}" !== n || (n = oe(e.toString) ? e.toString() : "" + e)) : n = e + " - (Missing JSON.stringify)"), n || "" } function vi(e, t) { var n = e; return e && ((n = e[gi] || e[hi] || "") && !ge(n) && (n = mi(n, !0)), e.filename && (n = n + " @" + (e.filename || "") + ":" + (e.lineno || "?") + ":" + (e.colno || "?"))), (n = t && "String" !== t && "Object" !== t && "Error" !== t && !~(n || "").indexOf(t) ? t + ": " + n : n) || "" } function yi(e) { return e && e.src && ge(e.src) && e.obj && fe(e.obj) } function Ii(e) { var t = e || "", e = (t = ge(t) ? t : ge(t[di]) ? t[di] : "" + t).split("\n"); return { src: t, obj: e } } function xi(e) { var t, n = null; if (e) try { e[di] ? n = Ii(e[di]) : e[li] && e[li][di] ? n = Ii(e[li][di]) : e.exception && e.exception[di] ? n = Ii(e.exception[di]) : yi(e) ? n = e : yi(e[fi]) ? n = e[fi] : window.opera && e[gi] ? n = function (e) { for (var t = [], n = e.split("\n"), r = 0; r < n.length; r++) { var i = n[r]; n[r + 1] && (i += "@" + n[r + 1], r++), t.push(i) } return { src: e, obj: t } }(e.message) : ge(e) ? n = Ii(e) : (t = e[gi] || e[hi] || "", ge(e[pi]) && (t && (t += "\n"), t += " from " + e[pi]), t && (n = Ii(t))) } catch (r) { n = Ii(r) } return n || { src: "", obj: null } } function Ci(e) { var t = ""; if (e && !(t = e.typeName || e.name || "")) try { var n = /function (.{1,})\(/.exec(e.constructor.toString()), t = n && 1 < n.length ? n[1] : "" } catch (r) { } return t } function Ti(e) { if (e) try { if (!ge(e)) { var t = Ci(e), n = mi(e, !1); return n && "{}" !== n || (e[li] && (t = Ci(e = e[li])), n = mi(e, !0)), n.indexOf(t) && "String" !== t ? t + ":" + n : n } } catch (r) { } return "" + (e || "") } var wi, Si = (h(bi, wi = function () { this.ver = 2, this.exceptions = [], this.properties = {}, this.measurements = {} }), bi.CreateAutoException = function (e, t, n, r, i, a, o, s) { var c = Ci(i || a || e); return { message: vi(e, c), url: t, lineNumber: n, columnNumber: r, error: Ti(i || a || e), evt: Ti(a || e), typeName: c, stackDetails: xi(o || i || a), errorSrc: s } }, bi.CreateFromInterface = function (t, e, n, r) { var i = e.exceptions && xe(e.exceptions, function (e) { return ki.CreateFromInterface(t, e) }); return new bi(t, p({}, e, { exceptions: i }), n, r) }, bi.prototype.toInterface = function () { var e = this.exceptions, t = this.properties, n = this.measurements, r = this.severityLevel; this.ver; var i = this.problemGroup, a = this.id, o = this.isManual; return { ver: "4.0", exceptions: e instanceof Array && xe(e, function (e) { return e.toInterface() }) || undefined, severityLevel: r, properties: t, measurements: n, problemGroup: i, id: a, isManual: o } }, bi.CreateSimpleException = function (e, t, n, r, i, a) { return { exceptions: [{ hasFullStack: !0, message: e, stack: i, typeName: t }] } }, bi.envelopeType = "Microsoft.ApplicationInsights.{0}.Exception", bi.dataType = "ExceptionData", bi.formatError = Ti, bi); function bi(e, t, n, r, i, a) { var o, s = wi.call(this) || this; return s.aiDataContract = { ver: 1, exceptions: 1, severityLevel: 0, properties: 0, measurements: 0 }, ae(o = t) && "ver" in o && "exceptions" in o && "properties" in o ? (s.exceptions = t.exceptions, s.properties = t.properties, s.measurements = t.measurements, t.severityLevel && (s.severityLevel = t.severityLevel), t.id && (s.id = t.id), t.problemGroup && (s.problemGroup = t.problemGroup), s.ver = 2, ne(t.isManual) || (s.isManual = t.isManual)) : (s.exceptions = [new ki(e, t, n = n || {})], s.properties = Zn(e, n), s.measurements = Qn(e, r), i && (s.severityLevel = i), a && (s.id = a)), s } var Ei, ki = (h(Ai, Ei = ci), Ai.prototype.toInterface = function () { var e = this.parsedStack instanceof Array && xe(this.parsedStack, function (e) { return e.toInterface() }); return { id: this.id, outerId: this.outerId, typeName: this.typeName, message: this.message, hasFullStack: this.hasFullStack, stack: this[di], parsedStack: e || undefined } }, Ai.CreateFromInterface = function (e, t) { var n = t.parsedStack instanceof Array && xe(t.parsedStack, function (e) { return _i.CreateFromInterface(e) }) || t.parsedStack; return new Ai(e, p({}, t, { parsedStack: n })) }, Ai); function Ai(e, u, t) { var n, r, i, a = Ei.call(this) || this; return a.aiDataContract = { id: 0, outerId: 0, typeName: 1, message: 1, hasFullStack: 0, stack: 0, parsedStack: 2 }, ae(i = u) && "hasFullStack" in i && "typeName" in i ? (a.typeName = u.typeName, a.message = u.message, a[di] = u[di], a.parsedStack = u.parsedStack, a.hasFullStack = u.hasFullStack) : (i = (n = u) && n.evt, pe(n) || (n = n[li] || i || n), a.typeName = Gn(e, Ci(n)) || mr, a.message = Jn(e, vi(u || n, a.typeName)) || mr, u = u[fi] || xi(u), a.parsedStack = function (e) { if ((e = u.obj) && 0 < e.length) { var t = [], n = 0, r = 0; if (ye(e, function (e) { e = e.toString(), _i.regex.test(e) && (e = new _i(e, n++), r += e.sizeInBytes, t.push(e)) }), 32768 < r) for (var i = 0, a = t.length - 1, o = 0, s = i, c = a; i < a;) { if (32768 < (o += t[i].sizeInBytes + t[a].sizeInBytes)) { t.splice(s, c - s + 1); break } s = i, c = a, i++, a-- } } return t }(), a[di] = Yn(e, (r = "", u && (u.obj ? ye(u.obj, function (e) { r += e + "\n" }) : r = u.src || ""), r)), a.hasFullStack = fe(a.parsedStack) && 0 < a.parsedStack.length, t && (t.typeName = t.typeName || a.typeName)), a } var Ni, _i = (h(Pi, Ni = si), Pi.CreateFromInterface = function (e) { return new Pi(e, null) }, Pi.prototype.toInterface = function () { return { level: this.level, method: this.method, assembly: this.assembly, fileName: this.fileName, line: this.line } }, Pi.regex = /^([\s]+at)?[\s]*([^\@\()]+?)[\s]*(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/, Pi.baseSize = 58, Pi); function Pi(e, t) { var n, r = Ni.call(this) || this; return r.sizeInBytes = 0, r.aiDataContract = { level: 1, method: 1, assembly: 0, fileName: 0, line: 0 }, "string" == typeof e ? (n = e, r.level = t, r.method = ui, r.assembly = Te(n), r.fileName = "", r.line = 0, (n = n.match(Pi.regex)) && 5 <= n.length && (r.method = Te(n[2]) || r.method, r.fileName = Te(n[4]), r.line = parseInt(n[5]) || 0)) : (r.level = e.level, r.method = e.method, r.assembly = e.assembly, r.fileName = e.fileName, r.line = e.line, r.sizeInBytes = 0), r.sizeInBytes += r.method.length, r.sizeInBytes += r.fileName.length, r.sizeInBytes += r.assembly.length, r.sizeInBytes += Pi.baseSize, r.sizeInBytes += r.level.toString().length, r.sizeInBytes += r.line.toString().length, r } var Ri, Li = function () { this.ver = 2, this.metrics = [], this.properties = {}, this.measurements = {} }; (pa = Ri = {})[pa.Measurement = 0] = "Measurement", pa[pa.Aggregation = 1] = "Aggregation"; var Di, Mi = (h(Fi, Di = function () { this.kind = Ri.Measurement }), Fi); function Fi() { var e = null !== Di && Di.apply(this, arguments) || this; return e.aiDataContract = { name: 1, kind: 0, value: 1, count: 0, min: 0, max: 0, stdDev: 0 }, e } var Ui, qi = (h(Vi, Ui = Li), Vi.envelopeType = "Microsoft.ApplicationInsights.{0}.Metric", Vi.dataType = "MetricData", Vi); function Vi(e, t, n, r, i, a, o, s) { var c = Ui.call(this) || this; c.aiDataContract = { ver: 1, metrics: 1, properties: 0 }; var u = new Mi; return u.count = 0 < r ? r : undefined, u.max = isNaN(a) || null === a ? undefined : a, u.min = isNaN(i) || null === i ? undefined : i, u.name = Gn(e, t) || mr, u.value = n, c.metrics = [u], c.properties = Zn(e, o), c.measurements = Qn(e, s), c } var Hi, Bi = (h(Oi, Hi = ga), Oi); function Oi() { var e = Hi.call(this) || this; return e.ver = 2, e.properties = {}, e.measurements = {}, e } var ji, zi = (h(Wi, ji = Bi), Wi.envelopeType = "Microsoft.ApplicationInsights.{0}.Pageview", Wi.dataType = "PageviewData", Wi); function Wi(e, t, n, r, i, a, o) { var s = ji.call(this) || this; return s.aiDataContract = { ver: 1, name: 0, url: 0, duration: 0, properties: 0, measurements: 0, id: 0 }, s.id = $n(e, o), s.url = Xn(e, n), s.name = Gn(e, t) || mr, isNaN(r) || (s.duration = ar(r)), s.properties = Zn(e, i), s.measurements = Qn(e, a), s } var Ki, Gi = (h(Xi, Ki = function () { this.ver = 2, this.success = !0, this.properties = {}, this.measurements = {} }), Xi.envelopeType = "Microsoft.ApplicationInsights.{0}.RemoteDependency", Xi.dataType = "RemoteDependencyData", Xi); function Xi(e, t, n, r, i, a, o, s, c, u, l, d) { void 0 === c && (c = "Ajax"); var f = Ki.call(this) || this; f.aiDataContract = { id: 1, ver: 1, name: 0, resultCode: 0, duration: 0, success: 0, data: 0, target: 0, type: 0, properties: 0, measurements: 0, kind: 0, value: 0, count: 0, min: 0, max: 0, stdDev: 0, dependencyKind: 0, dependencySource: 0, commandName: 0, dependencyTypeName: 0 }, f.id = t, f.duration = ar(i), f.success = a, f.resultCode = o + "", f.type = Gn(e, c); var p, g, o = (p = e, t = s, o = a = i = r, a = (c = n) && 0 < c.length ? (g = (s = Dr(c)).host, a || (null != s.pathname ? ("/" != ((n = 0 === s.pathname.length ? "/" : s.pathname)[0] || "") && (n = "/" + n), o = s.pathname, Gn(p, t ? t + " " + n : n)) : Gn(p, c))) : g = i, { target: g, name: a, data: o }); return f.data = Xn(e, r) || o.data, f.target = Gn(e, o.target), u && (f.target = f.target + " | " + u), f.name = Gn(e, o.name), f.properties = Zn(e, l), f.measurements = Qn(e, d), f } var Ji, Yi = (h(Zi, Ji = function () { this.ver = 2, this.properties = {}, this.measurements = {} }), Zi.envelopeType = "Microsoft.ApplicationInsights.{0}.Message", Zi.dataType = "MessageData", Zi); function Zi(e, t, n, r, i) { var a = Ji.call(this) || this; return a.aiDataContract = { ver: 1, message: 1, severityLevel: 0, properties: 0 }, a.message = Jn(e, t = t || mr), a.properties = Zn(e, r), a.measurements = Qn(e, i), n && (a.severityLevel = n), a } var Qi, u = (h($i, Qi = Bi), $i); function $i() { var e = Qi.call(this) || this; return e.ver = 2, e.properties = {}, e.measurements = {}, e } var ea, ta = (h(na, ea = u), na.envelopeType = "Microsoft.ApplicationInsights.{0}.PageviewPerformance", na.dataType = "PageviewPerformanceData", na); function na(e, t, n, r, i, a, o) { var s = ea.call(this) || this; return s.aiDataContract = { ver: 1, name: 0, url: 0, duration: 0, perfTotal: 0, networkConnect: 0, sentRequest: 0, receivedResponse: 0, domProcessing: 0, properties: 0, measurements: 0 }, s.url = Xn(e, n), s.name = Gn(e, t) || mr, s.properties = Zn(e, i), s.measurements = Qn(e, a), o && (s.domProcessing = o.domProcessing, s.duration = o.duration, s.networkConnect = o.networkConnect, s.perfTotal = o.perfTotal, s.receivedResponse = o.receivedResponse, s.sentRequest = o.sentRequest), s } var ra, ia, aa = (h(oa, ra = $r), oa); function oa(e, t) { var n = ra.call(this) || this; return n.aiDataContract = { baseType: 1, baseData: 1 }, n.baseType = e, n.baseData = t, n } (ha = ia = ia || {})[ha.Verbose = 0] = "Verbose", ha[ha.Information = 1] = "Information", ha[ha.Warning = 2] = "Warning", ha[ha.Error = 3] = "Error", ha[ha.Critical = 4] = "Critical"; var sa = (ca.getConfig = function (e, t, n, r) { return void 0 === r && (r = !1), t = (n && e.extensionConfig && e.extensionConfig[n] && !ne(e.extensionConfig[n][t]) ? e.extensionConfig[n] : e)[t], ne(t) ? r : t }, ca); function ca() { } function ua(e) { var t = "ai." + e + "."; return function (e) { return t + e } } var la, da, fa = ua("application"), ci = ua("device"), si = ua("location"), pa = ua("operation"), Li = ua("session"), ga = ua("user"), u = ua("cloud"), ha = ua("internal"), ma = (da = { applicationVersion: fa("ver"), applicationBuild: fa("build"), applicationTypeId: fa("typeId"), applicationId: fa("applicationId"), applicationLayer: fa("layer"), deviceId: ci("id"), deviceIp: ci("ip"), deviceLanguage: ci("language"), deviceLocale: ci("locale"), deviceModel: ci("model"), deviceFriendlyName: ci("friendlyName"), deviceNetwork: ci("network"), deviceNetworkName: ci("networkName"), deviceOEMName: ci("oemName"), deviceOS: ci("os"), deviceOSVersion: ci("osVersion"), deviceRoleInstance: ci("roleInstance"), deviceRoleName: ci("roleName"), deviceScreenResolution: ci("screenResolution"), deviceType: ci("type"), deviceMachineName: ci("machineName"), deviceVMName: ci("vmName"), deviceBrowser: ci("browser"), deviceBrowserVersion: ci("browserVersion"), locationIp: si("ip"), locationCountry: si("country"), locationProvince: si("province"), locationCity: si("city"), operationId: pa("id"), operationName: pa("name"), operationParentId: pa("parentId"), operationRootId: pa("rootId"), operationSyntheticSource: pa("syntheticSource"), operationCorrelationVector: pa("correlationVector"), sessionId: Li("id"), sessionIsFirst: Li("isFirst"), sessionIsNew: Li("isNew"), userAccountAcquisitionDate: ga("accountAcquisitionDate"), userAccountId: ga("accountId"), userAgent: ga("userAgent"), userId: ga("id"), userStoreRegion: ga("storeRegion"), userAuthUserId: ga("authUserId"), userAnonymousUserAcquisitionDate: ga("anonUserAcquisitionDate"), userAuthenticatedUserAcquisitionDate: ga("authUserAcquisitionDate"), cloudName: u("name"), cloudRole: u("role"), cloudRoleVer: u("roleVer"), cloudRoleInstance: u("roleInstance"), cloudEnvironment: u("environment"), cloudLocation: u("location"), cloudDeploymentUnit: u("deploymentUnit"), internalNodeName: ha("nodeName"), internalSdkVersion: ha("sdkVersion"), internalAgentVersion: ha("agentVersion"), internalSnippet: ha("snippet"), internalSdkSrc: ha("sdkSrc") }, h(va, la = function () { var n = this; ue(da, function (e, t) { n[e] = t }) }), va); function va() { return la.call(this) || this } var ya = (Ia.create = function (e, t, n, r, i, a) { if (n = Gn(r, n) || mr, ne(e) || ne(t) || ne(n)) throw Error("Input doesn't contain all required fields"); var o = { name: n, time: ve(new Date), iKey: "", ext: a || {}, tags: [], data: {}, baseType: t, baseData: e }; return ne(i) || ue(i, function (e, t) { o.data[e] = t }), o }, Ia); function Ia() { } var xa = { UserExt: "user", DeviceExt: "device", TraceExt: "trace", WebExt: "web", AppExt: "app", OSExt: "os", SessionExt: "ses", SDKExt: "sdk" }, Ca = new ma, Ta = "AppInsightsPropertiesPlugin", wa = "AppInsightsChannelPlugin", Sa = "ApplicationInsightsAnalytics", ba = ["snippet", "getDefaultConfig", "_hasLegacyInitializers", "_queue", "_processLegacyInitializers"], Ea = (ka.getDefaultConfig = function (e) { return (e = e || {}).endpointUrl = e.endpointUrl || "https://dc.services.visualstudio.com/v2/track", e.sessionRenewalMs = 18e5, e.sessionExpirationMs = 864e5, e.maxBatchSizeInBytes = 0 < e.maxBatchSizeInBytes ? e.maxBatchSizeInBytes : 102400, e.maxBatchInterval = isNaN(e.maxBatchInterval) ? 15e3 : e.maxBatchInterval, e.enableDebug = ir(e.enableDebug), e.disableExceptionTracking = ir(e.disableExceptionTracking), e.disableTelemetry = ir(e.disableTelemetry), e.verboseLogging = ir(e.verboseLogging), e.emitLineDelimitedJson = ir(e.emitLineDelimitedJson), e.diagnosticLogInterval = e.diagnosticLogInterval || 1e4, e.autoTrackPageVisitTime = ir(e.autoTrackPageVisitTime), (isNaN(e.samplingPercentage) || e.samplingPercentage <= 0 || 100 <= e.samplingPercentage) && (e.samplingPercentage = 100), e.disableAjaxTracking = ir(e.disableAjaxTracking), e.maxAjaxCallsPerView = isNaN(e.maxAjaxCallsPerView) ? 500 : e.maxAjaxCallsPerView, e.isBeaconApiDisabled = ir(e.isBeaconApiDisabled, !0), e.disableCorrelationHeaders = ir(e.disableCorrelationHeaders), e.correlationHeaderExcludedDomains = e.correlationHeaderExcludedDomains || ["*.blob.core.windows.net", "*.blob.core.chinacloudapi.cn", "*.blob.core.cloudapi.de", "*.blob.core.usgovcloudapi.net"], e.disableFlushOnBeforeUnload = ir(e.disableFlushOnBeforeUnload), e.disableFlushOnUnload = ir(e.disableFlushOnUnload, e.disableFlushOnBeforeUnload), e.enableSessionStorageBuffer = ir(e.enableSessionStorageBuffer, !0), e.isRetryDisabled = ir(e.isRetryDisabled), e.isCookieUseDisabled = ir(e.isCookieUseDisabled), e.isStorageUseDisabled = ir(e.isStorageUseDisabled), e.isBrowserLinkTrackingEnabled = ir(e.isBrowserLinkTrackingEnabled), e.enableCorsCorrelation = ir(e.enableCorsCorrelation), e }, ka.prototype.addTelemetryInitializers = function (e) { var t = this; this._hasLegacyInitializers || (this.appInsightsNew.addTelemetryInitializer(function (e) { t._processLegacyInitializers(e) }), this._hasLegacyInitializers = !0), this._queue.push(e) }, ka.prototype.getCookieMgr = function () { return this.appInsightsNew.getCookieMgr() }, ka.prototype.startTrackPage = function (e) { this.appInsightsNew.startTrackPage(e) }, ka.prototype.stopTrackPage = function (e, t, n, r) { this.appInsightsNew.stopTrackPage(e, t, n) }, ka.prototype.trackPageView = function (e, t, n, r, i) { this.appInsightsNew.trackPageView({ name: e, uri: t, properties: n, measurements: r }) }, ka.prototype.trackEvent = function (e, t, n) { this.appInsightsNew.trackEvent({ name: e }) }, ka.prototype.trackDependency = function (e, t, n, r, i, a, o) { this.appInsightsNew.trackDependencyData({ id: e, target: n, type: r, duration: i, properties: { HttpMethod: t }, success: a, responseCode: o }) }, ka.prototype.trackException = function (e, t, n, r, i) { this.appInsightsNew.trackException({ exception: e }) }, ka.prototype.trackMetric = function (e, t, n, r, i, a) { this.appInsightsNew.trackMetric({ name: e, average: t, sampleCount: n, min: r, max: i }) }, ka.prototype.trackTrace = function (e, t, n) { this.appInsightsNew.trackTrace({ message: e, severityLevel: n }) }, ka.prototype.flush = function (e) { this.appInsightsNew.flush(e) }, ka.prototype.setAuthenticatedUserContext = function (e, t, n) { this.appInsightsNew.context.user.setAuthenticatedUserContext(e, t, n) }, ka.prototype.clearAuthenticatedUserContext = function () { this.appInsightsNew.context.user.clearAuthenticatedUserContext() }, ka.prototype._onerror = function (e, t, n, r, i) { this.appInsightsNew._onerror({ message: e, url: t, lineNumber: n, columnNumber: r, error: i }) }, ka.prototype.startTrackEvent = function (e) { this.appInsightsNew.startTrackEvent(e) }, ka.prototype.stopTrackEvent = function (e, t, n) { this.appInsightsNew.stopTrackEvent(e, t, n) }, ka.prototype.downloadAndSetup = function (e) { Le("downloadAndSetup not implemented in web SKU") }, ka.prototype.updateSnippetDefinitions = function (e) { De(e, this, function (e) { return e && !~ba.indexOf(e) }) }, ka.prototype.loadAppInsights = function () { var r, i = this; this.config.iKey && (r = this.trackPageView, this.trackPageView = function (e, t, n) { r.call(i, null, e, t, n) }); var e = "logPageView"; return "function" == typeof this.snippet[e] && (this[e] = function (e, t, n) { i.trackPageView(null, e, t, n) }), "function" == typeof this.snippet[e = "logEvent"] && (this[e] = function (e, t, n) { i.trackEvent(e, t, n) }), this }, ka.prototype._processLegacyInitializers = function (e) { return e.tags[pr] = this._queue, e }, ka); function ka(e, t) { this._hasLegacyInitializers = !1, this._queue = [], this.config = ka.getDefaultConfig(e.config), this.appInsightsNew = t, this.context = { addTelemetryInitializer: this.addTelemetryInitializers.bind(this) } } var Aa = function Ds(g, h, t, m) { K(Ds, this, function (e) { var l, n = null, d = [], f = !1; function p() { t && ye(t.getTransmissionControls(), function (e) { ye(e, function (e) { return e.flush(!0) }) }) } t && (l = t.logger), e.trackPageView = function (r, i) { var a = r.name; !ne(a) && "string" == typeof a || (e = et(), a = r.name = e && e.title || ""); var e, o = r.uri; if (!ne(o) && "string" == typeof o || (e = nt(), o = r.uri = e && e.href || ""), !m.isPerformanceTimingSupported()) return g.sendPageViewInternal(r, i), p(), void l.throwInternal(E.WARNING, G.NavigationTimingNotSupported, "trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info."); var s, t, c = !1, u = m.getPerformanceTiming().navigationStart; 0 < u && (s = Wr(u, +new Date), m.shouldCollectDuration(s) || (s = undefined)), ne(i) || ne(i.duration) || (t = i.duration), !h && isNaN(t) || (isNaN(t) && ((i = i || {}).duration = s), g.sendPageViewInternal(r, i), p(), c = !0), i = i || {}, t = function () { var e, t = !1; try { m.isPerformanceTimingDataReady() ? (t = !0, e = { name: a, uri: o }, m.populatePageViewPerformanceEvent(e), e.isValid || c ? (c || (i.duration = e.durationMs, g.sendPageViewInternal(r, i)), f || (g.sendPageViewPerformanceInternal(e, i), f = !0)) : (i.duration = s, g.sendPageViewInternal(r, i))) : 0 < u && 6e4 < Wr(u, +new Date) && (t = !0, c || (i.duration = 6e4, g.sendPageViewInternal(r, i))) } catch (n) { l.throwInternal(E.CRITICAL, G.TrackPVFailedCalc, "trackPageView failed on page load calculation: " + Ae(n), { exception: ct(n) }) } return t }, d.push(t), n = n || setInterval(function () { var e = d.slice(0), t = !1; d = [], ye(e, function (e) { e() ? t = !0 : d.push(e) }), 0 === d.length && (clearInterval(n), n = null), t && p() }, 100) } }) }, Na = (_a.prototype.trackPreviousPageVisit = function (e, t) { try { var n = this.restartPageVisitTimer(e, t); n && this.pageVisitTimeTrackingHandler(n.pageName, n.pageUrl, n.pageVisitTime) } catch (r) { this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: " + ct(r)) } }, _a.prototype.restartPageVisitTimer = function (e, t) { try { var n = this.stopPageVisitTimer(); return this.startPageVisitTimer(e, t), n } catch (r) { return this._logger.warnToConsole("Call to restart failed: " + ct(r)), null } }, _a.prototype.startPageVisitTimer = function (e, t) { try { var n, r; kr() && (null != Ar(this._logger, this.prevPageVisitDataKeyName) && Le("Cannot call startPageVisit consecutively without first calling stopPageVisit"), n = new Pa(e, t), r = at().stringify(n), Nr(this._logger, this.prevPageVisitDataKeyName, r)) } catch (i) { this._logger.warnToConsole("Call to start failed: " + ct(i)) } }, _a.prototype.stopPageVisitTimer = function () { try { if (kr()) { var e = ke(), t = Ar(this._logger, this.prevPageVisitDataKeyName); if (t && it()) { var n = at().parse(t); return n.pageVisitTime = e - n.pageVisitStartTime, _r(this._logger, this.prevPageVisitDataKeyName), n } return null } return null } catch (r) { return this._logger.warnToConsole("Stop page visit timer failed: " + ct(r)), null } }, _a); function _a(e, t) { this.prevPageVisitDataKeyName = "prevPageVisitData", this.pageVisitTimeTrackingHandler = t, this._logger = e } var Pa = function (e, t) { this.pageVisitStartTime = ke(), this.pageName = e, this.pageUrl = t }, Ra = (La.prototype.populatePageViewPerformanceEvent = function (e) { e.isValid = !1; var t = this.getPerformanceNavigationTiming(), n = this.getPerformanceTiming(), r = 0, i = 0, a = 0, o = 0; (t || n) && (n = t ? (r = t.duration, i = 0 === t.startTime ? t.connectEnd : Wr(t.startTime, t.connectEnd), a = Wr(t.requestStart, t.responseStart), o = Wr(t.responseStart, t.responseEnd), Wr(t.responseEnd, t.loadEventEnd)) : (r = Wr(n.navigationStart, n.loadEventEnd), i = Wr(n.navigationStart, n.connectEnd), a = Wr(n.requestStart, n.responseStart), o = Wr(n.responseStart, n.responseEnd), Wr(n.responseEnd, n.loadEventEnd)), 0 === r ? this._logger.throwInternal(E.WARNING, G.ErrorPVCalc, "error calculating page view performance.", { total: r, network: i, request: a, response: o, dom: n }) : this.shouldCollectDuration(r, i, a, o, n) ? r < Math.floor(i) + Math.floor(a) + Math.floor(o) + Math.floor(n) ? this._logger.throwInternal(E.WARNING, G.ClientPerformanceMathError, "client performance math error.", { total: r, network: i, request: a, response: o, dom: n }) : (e.durationMs = r, e.perfTotal = e.duration = ar(r), e.networkConnect = ar(i), e.sentRequest = ar(a), e.receivedResponse = ar(o), e.domProcessing = ar(n), e.isValid = !0) : this._logger.throwInternal(E.WARNING, G.InvalidDurationValue, "Invalid page load duration value. Browser perf data won't be sent.", { total: r, network: i, request: a, response: o, dom: n })) }, La.prototype.getPerformanceTiming = function () { return this.isPerformanceTimingSupported() ? rt().timing : null }, La.prototype.getPerformanceNavigationTiming = function () { return this.isPerformanceNavigationTimingSupported() ? rt().getEntriesByType("navigation")[0] : null }, La.prototype.isPerformanceNavigationTimingSupported = function () { var e = rt(); return e && e.getEntriesByType && 0 < e.getEntriesByType("navigation").length }, La.prototype.isPerformanceTimingSupported = function () { var e = rt(); return e && e.timing }, La.prototype.isPerformanceTimingDataReady = function () { var e = rt(); return (e = e ? e.timing : 0) && 0 < e.domainLookupStart && 0 < e.navigationStart && 0 < e.responseStart && 0 < e.requestStart && 0 < e.loadEventEnd && 0 < e.responseEnd && 0 < e.connectEnd && 0 < e.domLoading }, La.prototype.shouldCollectDuration = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; var n = ["googlebot", "adsbot-google", "apis-google", "mediapartners-google"], r = (tt() || {}).userAgent, i = !1; if (r) for (var a = 0; a < n.length; a++)i = i || !!~r.toLowerCase().indexOf(n[a]); if (i) return !1; for (a = 0; a < e.length; a++)if (e[a] < 0 || e[a] >= this.MAX_DURATION_ALLOWED) return !1; return !0 }, La); function La(e) { this.MAX_DURATION_ALLOWED = 36e5, e && (this._logger = e.logger) } var Da = "duration", Ma = "event"; function Fa(e, t) { e && e.dispatchEvent && t && e.dispatchEvent(t) } var Ua, qa = (h(Va, Ua = bt), Va.getDefaultConfig = function (e) { return (e = e || {}).sessionRenewalMs = 18e5, e.sessionExpirationMs = 864e5, e.disableExceptionTracking = ir(e.disableExceptionTracking), e.autoTrackPageVisitTime = ir(e.autoTrackPageVisitTime), e.overridePageViewDuration = ir(e.overridePageViewDuration), e.enableUnhandledPromiseRejectionTracking = ir(e.enableUnhandledPromiseRejectionTracking), (isNaN(e.samplingPercentage) || e.samplingPercentage <= 0 || 100 <= e.samplingPercentage) && (e.samplingPercentage = 100), e.isStorageUseDisabled = ir(e.isStorageUseDisabled), e.isBrowserLinkTrackingEnabled = ir(e.isBrowserLinkTrackingEnabled), e.enableAutoRouteTracking = ir(e.enableAutoRouteTracking), e.namePrefix = e.namePrefix || "", e.enableDebug = ir(e.enableDebug), e.disableFlushOnBeforeUnload = ir(e.disableFlushOnBeforeUnload), e.disableFlushOnUnload = ir(e.disableFlushOnUnload, e.disableFlushOnBeforeUnload), e }, Va.Version = "2.6.3", Va); function Va() { var v, y, I, x, C, T = Ua.call(this) || this; return T.identifier = Sa, T.priority = 180, T.autoRoutePVDelay = 500, K(Va, T, function (h, m) { var e = nt(!0); x = e && e.href || "", h.getCookieMgr = function () { return tn(h.core) }, h.processTelemetry = function (a, o) { It(h.core, function () { return h.identifier + ":processTelemetry" }, function () { var e = !1, t = h._telemetryInitializers.length; o = h._getTelCtx(o); for (var n = 0; n < t; ++n) { var r = h._telemetryInitializers[n]; if (r) try { if (!1 === r.call(null, a)) { e = !0; break } } catch (i) { o.diagLog().throwInternal(E.CRITICAL, G.TelemetryInitializerFailed, "One of telemetry initializers failed, telemetry item will not be sent: " + Ae(i), { exception: ct(i) }, !0) } } e || h.processNext(a, o) }, function () { return { item: a } }, !a.sync) }, h.trackEvent = function (e, t) { try { var n = ya.create(e, ai.dataType, ai.envelopeType, h.diagLog(), t); h.core.track(n) } catch (r) { h.diagLog().throwInternal(E.WARNING, G.TrackTraceFailed, "trackTrace failed, trace will not be collected: " + Ae(r), { exception: ct(r) }) } }, h.startTrackEvent = function (e) { try { v.start(e) } catch (t) { h.diagLog().throwInternal(E.CRITICAL, G.StartTrackEventFailed, "startTrackEvent failed, event will not be collected: " + Ae(t), { exception: ct(t) }) } }, h.stopTrackEvent = function (e, t, n) { try { v.stop(e, undefined, t) } catch (r) { h.diagLog().throwInternal(E.CRITICAL, G.StopTrackEventFailed, "stopTrackEvent failed, event will not be collected: " + Ae(r), { exception: ct(r) }) } }, h.trackTrace = function (e, t) { try { var n = ya.create(e, Yi.dataType, Yi.envelopeType, h.diagLog(), t); h.core.track(n) } catch (r) { h.diagLog().throwInternal(E.WARNING, G.TrackTraceFailed, "trackTrace failed, trace will not be collected: " + Ae(r), { exception: ct(r) }) } }, h.trackMetric = function (e, t) { try { var n = ya.create(e, qi.dataType, qi.envelopeType, h.diagLog(), t); h.core.track(n) } catch (r) { h.diagLog().throwInternal(E.CRITICAL, G.TrackMetricFailed, "trackMetric failed, metric will not be collected: " + Ae(r), { exception: ct(r) }) } }, h.trackPageView = function (e, t) { try { var n = e || {}; h._pageViewManager.trackPageView(n, p({}, n.properties, n.measurements, t)), h.config.autoTrackPageVisitTime && h._pageVisitTimeManager.trackPreviousPageVisit(n.name, n.uri) } catch (r) { h.diagLog().throwInternal(E.CRITICAL, G.TrackPVFailed, "trackPageView failed, page view will not be collected: " + Ae(r), { exception: ct(r) }) } }, h.sendPageViewInternal = function (e, t, n) { var r = et(); r && (e.refUri = e.refUri === undefined ? r.referrer : e.refUri), n = ya.create(e, zi.dataType, zi.envelopeType, h.diagLog(), t, n), h.core.track(n) }, h.sendPageViewPerformanceInternal = function (e, t, n) { n = ya.create(e, ta.dataType, ta.envelopeType, h.diagLog(), t, n), h.core.track(n) }, h.trackPageViewPerformance = function (e, t) { try { h._pageViewPerformanceManager.populatePageViewPerformanceEvent(e), h.sendPageViewPerformanceInternal(e, t) } catch (n) { h.diagLog().throwInternal(E.CRITICAL, G.TrackPVFailed, "trackPageViewPerformance failed, page view will not be collected: " + Ae(n), { exception: ct(n) }) } }, h.startTrackPage = function (e) { try { var t; "string" != typeof e && (e = (t = et()) && t.title || ""), y.start(e) } catch (n) { h.diagLog().throwInternal(E.CRITICAL, G.StartTrackFailed, "startTrackPage failed, page view may not be collected: " + Ae(n), { exception: ct(n) }) } }, h.stopTrackPage = function (e, t, n, r) { try { var i, a; "string" != typeof e && (e = (i = et()) && i.title || ""), "string" != typeof t && (t = (a = nt()) && a.href || ""), y.stop(e, t, n, r), h.config.autoTrackPageVisitTime && h._pageVisitTimeManager.trackPreviousPageVisit(e, t) } catch (o) { h.diagLog().throwInternal(E.CRITICAL, G.StopTrackFailed, "stopTrackPage failed, page view will not be collected: " + Ae(o), { exception: ct(o) }) } }, h.sendExceptionInternal = function (e, t, n) { var r = e.exception || e.error || Error(mr), e = new Si(h.diagLog(), r, e.properties || t, e.measurements, e.severityLevel, e.id).toInterface(), n = ya.create(e, Si.dataType, Si.envelopeType, h.diagLog(), t, n); h.core.track(n) }, h.trackException = function (e, t) { try { h.sendExceptionInternal(e, t) } catch (n) { h.diagLog().throwInternal(E.CRITICAL, G.TrackExceptionFailed, "trackException failed, exception will not be collected: " + Ae(n), { exception: ct(n) }) } }, h._onerror = function (e) { var t, n, r, i = e && e.error, a = e && e.evt; try { a || (t = Qe()) && (a = t[Ma]); var o = e && e.url || (et() || {}).URL, s = e.errorSrc || "window.onerror@" + o + ":" + (e.lineNumber || 0) + ":" + (e.columnNumber || 0), c = { errorSrc: s, url: o, lineNumber: e.lineNumber || 0, columnNumber: e.columnNumber || 0, message: e.message }; cr(e.message, e.url, e.lineNumber, e.columnNumber, e.error) ? (n = Si.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.", o, e.lineNumber || 0, e.columnNumber || 0, i, a, null, s), r = c, r = ya.create(n, Si.dataType, Si.envelopeType, h.diagLog(), r), h.core.track(r)) : (e.errorSrc || (e.errorSrc = s), h.trackException({ exception: e, severityLevel: ia.Error }, c)) } catch (u) { i = i ? i.name + ", " + i.message : "null", h.diagLog().throwInternal(E.CRITICAL, G.ExceptionWhileLoggingError, "_onError threw exception while logging error, error will not be collected: " + Ae(u), { exception: ct(u), errorString: i }) } }, h.addTelemetryInitializer = function (e) { h._telemetryInitializers.push(e) }, h.initialize = function (e, t, n, r) { if (!h.isInitialized()) { if (ne(t)) throw Error("Error initializing"); m.initialize(e, t, n, r), h.setInitialized(!1); var i = h._getTelCtx(), a = h.identifier; h.config = i.getExtCfg(a), (t = Va.getDefaultConfig(e)) !== undefined && ue(t, function (e, t) { h.config[e] = i.getConfig(a, e, t), h.config[e] === undefined && (h.config[e] = t) }), h.config.isStorageUseDisabled && Tr(), r = { instrumentationKey: function () { return e.instrumentationKey }, accountId: function () { return h.config.accountId || e.accountId }, sessionRenewalMs: function () { return h.config.sessionRenewalMs || e.sessionRenewalMs }, sessionExpirationMs: function () { return h.config.sessionExpirationMs || e.sessionExpirationMs }, sampleRate: function () { return h.config.samplingPercentage || e.samplingPercentage }, sdkExtension: function () { return h.config.sdkExtension || e.sdkExtension }, isBrowserLinkTrackingEnabled: function () { return h.config.isBrowserLinkTrackingEnabled || e.isBrowserLinkTrackingEnabled }, appId: function () { return h.config.appId || e.appId } }, h._pageViewPerformanceManager = new Ra(h.core), h._pageViewManager = new Aa(T, h.config.overridePageViewDuration, h.core, h._pageViewPerformanceManager), h._pageVisitTimeManager = new Na(h.diagLog(), function (e, t, n) { h.trackMetric({ name: "PageVisitTime", average: n, max: n, min: n, sampleCount: 1 }, t = { PageName: e, PageUrl: t }) }), h._telemetryInitializers = h._telemetryInitializers || [], r.isBrowserLinkTrackingEnabled() || (g = ["/browserLinkSignalR/", "/__browserLink/"], h._telemetryInitializers.push(function (e) { if (e.baseType === Gi.dataType) { var t = e.baseData; if (t) for (var n = 0; n < g.length; n++)if (t.target && ~t.target.indexOf(g[n])) return !1 } return !0 })), (v = new Ha(h.diagLog(), "trackEvent")).action = function (e, t, n, r) { (r = r || {})[Da] = n.toString(), h.trackEvent({ name: e, properties: r }) }, (y = new Ha(h.diagLog(), "trackPageView")).action = function (e, t, n, r, i) { (r = ne(r) ? {} : r)[Da] = n.toString(), h.sendPageViewInternal({ name: e, uri: t, properties: r, measurements: i }, r) }; var s, o, c, u, l, d = Qe(), t = typeof history === w && history ? history : Ye(Ve), f = nt(!0), p = T; !1 === h.config.disableExceptionTracking && !h.config.autoExceptionInstrumented && d && (s = d.onerror, d.onerror = function (e, t, n, r, i) { var a = d[Ma], o = s && s(e, t, n, r, i); return !0 !== o && p._onerror(Si.CreateAutoException(e, t, n, r, i, a)), o }, h.config.autoExceptionInstrumented = !0), !1 === h.config.disableExceptionTracking && !0 === h.config.enableUnhandledPromiseRejectionTracking && !h.config.autoUnhandledPromiseInstrumented && d && (o = d[r = "onunhandledrejection"], d[r] = function (e) { var t = d[Ma], n = o && o.call(d, e); return !0 !== n && p._onerror(Si.CreateAutoException(e.reason.toString(), f ? f.href : "", 0, 0, e, t)), n }, h.config.autoUnhandledPromiseInstrumented = !0), !0 === h.config.enableAutoRouteTracking && t && oe(t.pushState) && oe(t.replaceState) && d && "undefined" != typeof Event && (c = T, ye(n, function (e) { e.identifier === Ta && (I = e) }), t.pushState = (l = t.pushState, function () { var e = l.apply(this, arguments); return Fa(d, rr(c.config.namePrefix + "pushState")), Fa(d, rr(c.config.namePrefix + "locationchange")), e }), t.replaceState = (u = t.replaceState, function () { var e = u.apply(this, arguments); return Fa(d, rr(c.config.namePrefix + "replaceState")), Fa(d, rr(c.config.namePrefix + "locationchange")), e }), d.addEventListener && (d.addEventListener(c.config.namePrefix + "popstate", function () { Fa(d, rr(c.config.namePrefix + "locationchange")) }), d.addEventListener(c.config.namePrefix + "locationchange", function () { var e; I && I.context && I.context.telemetryTrace && (I.context.telemetryTrace.traceID = Nn(), e = "_unknown_", f && f.pathname && (e = f.pathname + (f.hash || "")), I.context.telemetryTrace.name = e), C && (x = C), C = f && f.href || "", setTimeout((function (e) { c.trackPageView({ refUri: e, properties: { duration: 0 } }) }).bind(T, x), c.autoRoutePVDelay) }))), h.setInitialized(!0) } var g } }), T } var Ha = function (a, e) { var o = this, s = {}; o.start = function (e) { "undefined" != typeof s[e] && a.throwInternal(E.WARNING, G.StartCalledMoreThanOnce, "start was called more than once for this event without calling stop.", { name: e, key: e }, !0), s[e] = +new Date }, o.stop = function (e, t, n, r) { var i = s[e]; isNaN(i) ? a.throwInternal(E.WARNING, G.StopCalledWithoutStart, "stop was called without a corresponding start.", { name: e, key: e }, !0) : (i = Wr(i, +new Date), o.action(e, t, i, n, r)), delete s[e], s[e] = undefined } }, Ba = function Ms(n) { var r = []; K(Ms, this, function (t) { t.enqueue = function (e) { r.push(e) }, t.count = function () { return r.length }, t.clear = function () { r.length = 0 }, t.getItems = function () { return r.slice(0) }, t.batchPayloads = function (e) { return e && 0 < e.length ? n.emitLineDelimitedJson() ? e.join("\n") : "[" + e.join(",") + "]" : null }, t.markAsSent = function (e) { t.clear() }, t.clearSent = function (e) { } }) }, Oa = (ja.BUFFER_KEY = "AI_buffer", ja.SENT_BUFFER_KEY = "AI_sentBuffer", ja.MAX_BUFFER_SIZE = 2e3, ja); function ja(o, s) { var c, u = !1; K(ja, this, function (e) { var t = i(ja.BUFFER_KEY), n = i(ja.SENT_BUFFER_KEY); function r(t, e) { var n = []; return ye(e, function (e) { oe(e) || -1 !== Ie(t, e) || n.push(e) }), n } function i(e) { try { var e = s.namePrefix && s.namePrefix() ? s.namePrefix() + "_" + e : e, t = Ar(o, e); if (t) { var n = at().parse(t); if ((n = ge(n) ? at().parse(n) : n) && fe(n)) return n } } catch (r) { o.throwInternal(E.CRITICAL, G.FailedToRestoreStorageBuffer, " storage key: " + e + ", " + Ae(r), { exception: ct(r) }) } return [] } function a(e, t) { try { var e = s.namePrefix && s.namePrefix() ? s.namePrefix() + "_" + e : e, n = JSON.stringify(t); Nr(o, e, n) } catch (r) { Nr(o, e, JSON.stringify([])), o.throwInternal(E.WARNING, G.FailedToSetStorageBuffer, " storage key: " + e + ", " + Ae(r) + ". Buffer cleared", { exception: ct(r) }) } } (c = t.concat(n)).length > ja.MAX_BUFFER_SIZE && (c.length = ja.MAX_BUFFER_SIZE), a(ja.SENT_BUFFER_KEY, []), a(ja.BUFFER_KEY, c), e.enqueue = function (e) { c.length >= ja.MAX_BUFFER_SIZE ? u || (o.throwInternal(E.WARNING, G.SessionStorageBufferFull, "Maximum buffer size reached: " + c.length, !0), u = !0) : (c.push(e), a(ja.BUFFER_KEY, c)) }, e.count = function () { return c.length }, e.clear = function () { c = [], a(ja.BUFFER_KEY, []), a(ja.SENT_BUFFER_KEY, []), u = !1 }, e.getItems = function () { return c.slice(0) }, e.batchPayloads = function (e) { return e && 0 < e.length ? s.emitLineDelimitedJson() ? e.join("\n") : "[" + e.join(",") + "]" : null }, e.markAsSent = function (e) { c = r(e, c), a(ja.BUFFER_KEY, c); var t = i(ja.SENT_BUFFER_KEY); t instanceof Array && e instanceof Array && ((t = t.concat(e)).length > ja.MAX_BUFFER_SIZE && (o.throwInternal(E.CRITICAL, G.SessionStorageBufferFull, "Sent buffer reached its maximum size: " + t.length, !0), t.length = ja.MAX_BUFFER_SIZE), a(ja.SENT_BUFFER_KEY, t)) }, e.clearSent = function (e) { e = r(e, e = i(ja.SENT_BUFFER_KEY)), a(ja.SENT_BUFFER_KEY, e) } }) } var za = "baseType", Wa = "baseData", Ka = "properties"; function Ga(e, t, n) { return Ne(e, t, n, Re) } var Xa = (Ja.extractPropsAndMeasurements = function (e, n, r) { ne(e) || ue(e, function (e, t) { he(t) ? r[e] = t : ge(t) ? n[e] = t : it() && (n[e] = at().stringify(t)) }) }, Ja.createEnvelope = function (e, t, n, r) { return Ga(r = new ni(e, r, t), "sampleRate", n[fr]), (n[Wa] || {}).startTime && (r.time = ve(n[Wa].startTime)), r.iKey = n.iKey, t = n.iKey.replace(/-/g, ""), r.name = r.name.replace("{0}", t), Ja.extractPartAExtensions(n, r), n.tags = n.tags || [], Me(r) }, Ja.extractPartAExtensions = function (e, t) { var n = t.tags = t.tags || {}, r = e.ext = e.ext || {}, i = e.tags = e.tags || [], a = r.user; a && (Ga(n, Ca.userAuthUserId, a.authId), Ga(n, Ca.userId, a.id || a.localId)), (a = r.app) && Ga(n, Ca.sessionId, a.sesId), (a = r.device) && (Ga(n, Ca.deviceId, a.id || a.localId), Ga(n, Ca.deviceType, a.deviceClass), Ga(n, Ca.deviceIp, a.ip), Ga(n, Ca.deviceModel, a.model), Ga(n, Ca.deviceType, a.deviceType)), (a = e.ext.web) && (Ga(n, Ca.deviceLanguage, a.browserLang), Ga(n, Ca.deviceBrowserVersion, a.browserVer), Ga(n, Ca.deviceBrowser, a.browser), Ga(e = (e = (e = t.data = t.data || {})[Wa] = e[Wa] || {})[Ka] = e[Ka] || {}, "domain", a.domain), Ga(e, "isManual", a.isManual ? "true" : null), Ga(e, "screenRes", a.screenRes), Ga(e, "userConsent", a.userConsent ? "true" : null)), (a = r.os) && Ga(n, Ca.deviceOS, a.name), (r = r.trace) && (Ga(n, Ca.operationParentId, r.parentID), Ga(n, Ca.operationName, r.name), Ga(n, Ca.operationId, r.traceID)); for (var o = {}, s = i.length - 1; 0 <= s; s--)ue(i[s], function (e, t) { o[e] = t }), i.splice(s, 1); ue(i, function (e, t) { o[e] = t }), (n = p({}, n, o))[Ca.internalSdkVersion] || (n[Ca.internalSdkVersion] = "javascript:" + Ja.Version), t.tags = Me(n) }, Ja.prototype.Init = function (e, t) { this._logger = e, ne(t[Wa]) && this._logger.throwInternal(E.CRITICAL, G.TelemetryEnvelopeInvalid, "telemetryItem.baseData cannot be null.") }, Ja.Version = "2.6.3", Ja); function Ja() { } var Ya, Za = (h(Qa, Ya = Xa), Qa.prototype.Create = function (e, t) { Ya.prototype.Init.call(this, e, t); var n = t[Wa].measurements || {}, r = t[Wa][Ka] || {}; Xa.extractPropsAndMeasurements(t.data, r, n); var i = t[Wa]; if (ne(i)) return e.warnToConsole("Invalid input for dependency data"), null; var a = i[Ka] && i[Ka][gr] ? i[Ka][gr] : "GET", n = new Gi(e, i.id, i.target, i.name, i.duration, i.success, i.responseCode, a, i.type, i.correlationContext, r, n), n = new aa(Gi.dataType, n); return Xa.createEnvelope(e, Gi.envelopeType, t, n) }, Qa.DependencyEnvelopeCreator = new Qa, Qa); function Qa() { return null !== Ya && Ya.apply(this, arguments) || this } var $a, eo = (h(to, $a = Xa), to.prototype.Create = function (e, t) { $a.prototype.Init.call(this, e, t); var n = {}, r = {}; t[za] !== ai.dataType && (n.baseTypeSource = t[za]), t[za] === ai.dataType ? (n = t[Wa][Ka] || {}, r = t[Wa].measurements || {}) : t[Wa] && Xa.extractPropsAndMeasurements(t[Wa], n, r), Xa.extractPropsAndMeasurements(t.data, n, r); var i = t[Wa].name, r = new ai(e, i, n, r), r = new aa(ai.dataType, r); return Xa.createEnvelope(e, ai.envelopeType, t, r) }, to.EventEnvelopeCreator = new to, to); function to() { return null !== $a && $a.apply(this, arguments) || this } var no, ro = (h(io, no = Xa), io.prototype.Create = function (e, t) { no.prototype.Init.call(this, e, t); var n = t[Wa].measurements || {}, r = t[Wa][Ka] || {}; Xa.extractPropsAndMeasurements(t.data, r, n); var i = t[Wa], n = Si.CreateFromInterface(e, i, r, n), n = new aa(Si.dataType, n); return Xa.createEnvelope(e, Si.envelopeType, t, n) }, io.ExceptionEnvelopeCreator = new io, io); function io() { return null !== no && no.apply(this, arguments) || this } var ao, oo = (h(so, ao = Xa), so.prototype.Create = function (e, t) { ao.prototype.Init.call(this, e, t); var n = t[Wa], r = n[Ka] || {}, i = n.measurements || {}; return Xa.extractPropsAndMeasurements(t.data, r, i), i = new qi(e, n.name, n.average, n.sampleCount, n.min, n.max, r, i), i = new aa(qi.dataType, i), Xa.createEnvelope(e, qi.envelopeType, t, i) }, so.MetricEnvelopeCreator = new so, so); function so() { return null !== ao && ao.apply(this, arguments) || this } var co, uo = (h(lo, co = Xa), lo.prototype.Create = function (e, t) { co.prototype.Init.call(this, e, t); var n, r = "duration"; ne(o = t[Wa]) || ne(o[Ka]) || ne(o[Ka][r]) ? ne(t.data) || ne(t.data[r]) || (n = t.data[r], delete t.data[r]) : (n = o[Ka][r], delete o[Ka][r]); var i = t[Wa]; ((t.ext || {}).trace || {}).traceID && (c = t.ext.trace.traceID); var a = i.id || c, o = i.name, r = i.uri, s = i[Ka] || {}, c = i.measurements || {}; return ne(i.refUri) || (s.refUri = i.refUri), ne(i.pageType) || (s.pageType = i.pageType), ne(i.isLoggedIn) || (s.isLoggedIn = i.isLoggedIn.toString()), ne(i[Ka]) || ue(i[Ka], function (e, t) { s[e] = t }), Xa.extractPropsAndMeasurements(t.data, s, c), a = new zi(e, o, r, n, s, c, a), a = new aa(zi.dataType, a), Xa.createEnvelope(e, zi.envelopeType, t, a) }, lo.PageViewEnvelopeCreator = new lo, lo); function lo() { return null !== co && co.apply(this, arguments) || this } var fo, po = (h(go, fo = Xa), go.prototype.Create = function (e, t) { fo.prototype.Init.call(this, e, t); var n = t[Wa], r = n.name, i = n.uri || n.url, a = n[Ka] || {}, o = n.measurements || {}; return Xa.extractPropsAndMeasurements(t.data, a, o), n = new ta(e, r, i, undefined, a, o, n), n = new aa(ta.dataType, n), Xa.createEnvelope(e, ta.envelopeType, t, n) }, go.PageViewPerformanceEnvelopeCreator = new go, go); function go() { return null !== fo && fo.apply(this, arguments) || this } var ho, mo = (h(vo, ho = Xa), vo.prototype.Create = function (e, t) { ho.prototype.Init.call(this, e, t); var n = t[Wa].message, r = t[Wa].severityLevel, i = t[Wa][Ka] || {}, a = t[Wa].measurements || {}; return Xa.extractPropsAndMeasurements(t.data, i, a), a = new Yi(e, n, r, i, a), a = new aa(Yi.dataType, a), Xa.createEnvelope(e, Yi.envelopeType, t, a) }, vo.TraceEnvelopeCreator = new vo, vo); function vo() { return null !== ho && ho.apply(this, arguments) || this } var yo = function Fs(d) { K(Fs, this, function (e) { function u(o, s) { var e = "__aiCircularRefCheck", c = {}; if (!o) return d.throwInternal(E.CRITICAL, G.CannotSerializeObject, "cannot serialize object because it is null or undefined", { name: s }, !0), c; if (o[e]) return d.throwInternal(E.WARNING, G.CircularReferenceDetected, "Circular reference detected while serializing object", { name: s }, !0), c; if (o.aiDataContract) return o[e] = !0, ue(o.aiDataContract, function (e, t) { var n = oe(t) ? 1 & t() : 1 & t, r = oe(t) ? 4 & t() : 4 & t, i = 2 & t, a = o[e] !== undefined, t = ae(o[e]) && null !== o[e]; !n || a || i ? r || (r = void 0, (r = t ? (i ? l : u)(o[e], e) : o[e]) !== undefined && (c[e] = r)) : d.throwInternal(E.CRITICAL, G.MissingRequiredFieldSpecification, "Missing required field specification. The field is required but not present on source", { field: e, name: s }) }), delete o[e], c; if ("measurements" === s) c = n(o, "number", s); else if ("properties" === s) c = n(o, "string", s); else if ("tags" === s) c = n(o, "string", s); else if (fe(o)) c = l(o, s); else { d.throwInternal(E.WARNING, G.CannotSerializeObjectNonSerializable, "Attempting to serialize an object which does not implement ISerializable", { name: s }, !0); try { at().stringify(o), c = o } catch (t) { d.throwInternal(E.CRITICAL, G.CannotSerializeObject, t && oe(t.toString) ? t.toString() : "Error serializing object", null, !0) } } return c } function l(e, t) { if (e) if (fe(e)) for (var n = [], r = 0; r < e.length; r++) { var i = u(e[r], t + "[" + r + "]"); n.push(i) } else d.throwInternal(E.CRITICAL, G.ItemNotInArray, "This field was specified as an array in the contract but the item is not an array.\r\n", { name: t }, !0); return n } function n(e, n, r) { var i; return e && (i = {}, ue(e, function (e, t) { "string" === n ? t === undefined ? i[e] = "undefined" : null === t ? i[e] = "null" : t.toString ? i[e] = t.toString() : i[e] = "invalid field: toString() is not defined." : "number" === n ? t === undefined ? i[e] = "undefined" : i[e] = null === t ? "null" : isNaN(t = parseFloat(t)) ? "NaN" : t : (i[e] = "invalid field: " + r + " is of unknown type.", d.throwInternal(E.CRITICAL, i[e], null, !0)) })), i } e.serialize = function (e) { e = u(e, "root"); try { return at().stringify(e) } catch (t) { d.throwInternal(E.CRITICAL, G.CannotSerializeObject, t && oe(t.toString) ? t.toString() : "Error serializing object", null, !0) } } }) }; function Io() { var o = Qe(), s = et(), c = !1, u = !0; K(Io, this, function (e) { try { var t, n; o && Rn.Attach(o, "online", r) && (Rn.Attach(o, "offline", i), c = !0), s && (te((t = s.body || s).ononline) || (t.ononline = r, t.onoffline = i, c = !0)), !c || (n = tt()) && !ne(n.onLine) && (u = n.onLine) } catch (a) { c = !1 } function r() { u = !0 } function i() { u = !1 } e.isListening = c, e.isOnline = function () { var e = !0, t = tt(); return c ? e = u : t && !ne(t.onLine) && (e = t.onLine), e }, e.isOffline = function () { return !e.isOnline() } }) } var xo = Io.Offline = new Io, Co = (To.prototype.getHashCodeScore = function (e) { return this.getHashCode(e) / To.INT_MAX_VALUE * 100 }, To.prototype.getHashCode = function (e) { if ("" === e) return 0; for (; e.length < To.MIN_INPUT_LENGTH;)e = e.concat(e); for (var t = 5381, n = 0; n < e.length; ++n)t = (t << 5) + t + e.charCodeAt(n), t &= t; return Math.abs(t) }, To.INT_MAX_VALUE = 2147483647, To.MIN_INPUT_LENGTH = 8, To); function To() { } var wo = (So.prototype.getSamplingScore = function (e) { return e.tags && e.tags[this.keys.userId] ? this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]) : e.ext && e.ext.user && e.ext.user.id ? this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id) : e.tags && e.tags[this.keys.operationId] ? this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]) : e.ext && e.ext.telemetryTrace && e.ext.telemetryTrace.traceID ? this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID) : 100 * Math.random() }, So); function So() { this.hashCodeGeneragor = new Co, this.keys = new ma } var bo = (Eo.prototype.isSampledIn = function (e) { var t = this.sampleRate; return null === t || t === undefined || 100 <= t || e.baseType === qi.dataType || this.samplingScoreGenerator.getSamplingScore(e) < t }, Eo); function Eo(e, t) { this.INT_MAX_VALUE = 2147483647, this._logger = t || ft(null), (100 < e || e < 0) && (this._logger.throwInternal(E.WARNING, G.SampleRateOutOfRange, "Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.", { samplingRate: e }, !0), this.sampleRate = 100), this.sampleRate = e, this.samplingScoreGenerator = new wo } function ko(e) { try { return e.responseText } catch (t) { } return null } var Ao, No = (h(_o, Ao = bt), _o.constructEnvelope = function (e, t, n) { var r = t === e.iKey || ne(t) ? e : p({}, e, { iKey: t }); switch (r.baseType) { case ai.dataType: return eo.EventEnvelopeCreator.Create(n, r); case Yi.dataType: return mo.TraceEnvelopeCreator.Create(n, r); case zi.dataType: return uo.PageViewEnvelopeCreator.Create(n, r); case ta.dataType: return po.PageViewPerformanceEnvelopeCreator.Create(n, r); case Si.dataType: return ro.ExceptionEnvelopeCreator.Create(n, r); case qi.dataType: return oo.MetricEnvelopeCreator.Create(n, r); case Gi.dataType: return Za.DependencyEnvelopeCreator.Create(n, r); default: return eo.EventEnvelopeCreator.Create(n, r) } }, _o._getDefaultAppInsightsChannelConfig = function () { return { endpointUrl: function () { return "https://dc.services.visualstudio.com/v2/track" }, emitLineDelimitedJson: function () { return !1 }, maxBatchInterval: function () { return 15e3 }, maxBatchSizeInBytes: function () { return 102400 }, disableTelemetry: function () { return !1 }, enableSessionStorageBuffer: function () { return !0 }, isRetryDisabled: function () { return !1 }, isBeaconApiDisabled: function () { return !0 }, onunloadDisableBeacon: function () { return !1 }, instrumentationKey: function () { return undefined }, namePrefix: function () { return undefined }, samplingPercentage: function () { return 100 }, customHeaders: function () { return undefined } } }, _o._getEmptyAppInsightsChannelConfig = function () { return { endpointUrl: undefined, emitLineDelimitedJson: undefined, maxBatchInterval: undefined, maxBatchSizeInBytes: undefined, disableTelemetry: undefined, enableSessionStorageBuffer: undefined, isRetryDisabled: undefined, isBeaconApiDisabled: undefined, onunloadDisableBeacon: undefined, instrumentationKey: undefined, namePrefix: undefined, samplingPercentage: undefined, customHeaders: undefined } }, _o); function _o() { var I, x, C, T, w, S = Ao.call(this) || this; S.priority = 1001, S.identifier = wa, S._XMLHttpRequestSupported = !1; var b = {}; return K(_o, S, function (c, o) { function e() { Le("Method not implemented.") } function a(e, t, n, r, i, a) { var o = null; c._appId || (o = f(a)) && o.appId && (c._appId = o.appId), (e < 200 || 300 <= e) && 0 !== e ? (301 !== e && 308 !== e || s(n)) && !c._senderConfig.isRetryDisabled() && h(e) ? (p(t), c.diagLog().throwInternal(E.WARNING, G.TransmissionFailed, ". Response code " + e + ". Will retry to send " + t.length + " items.")) : c._onError(t, i) : xo.isOffline() ? c._senderConfig.isRetryDisabled() || (p(t, 10), c.diagLog().throwInternal(E.WARNING, G.TransmissionFailed, ". Offline - Response Code: " + e + ". Offline status: " + xo.isOffline() + ". Will retry to send " + t.length + " items.")) : (s(n), 206 === e ? (o = o || f(a)) && !c._senderConfig.isRetryDisabled() ? c._onPartialSuccess(t, o) : c._onError(t, i) : (I = 0, c._onSuccess(t, r))) } function s(e) { return !(10 <= w) && !ne(e) && "" !== e && e !== c._senderConfig.endpointUrl() && (c._senderConfig.endpointUrl = function () { return e }, ++w, 1) } function u(e, t) { var n = c._senderConfig.endpointUrl(), r = c._buffer.batchPayloads(e), r = new Blob([r], { type: "text/plain;charset=UTF-8" }); tt().sendBeacon(n, r) ? (c._buffer.markAsSent(e), c._onSuccess(e, e.length)) : (l(e, !0), c.diagLog().throwInternal(E.WARNING, G.TransmissionFailed, ". Failed to send telemetry with Beacon API, retried with xhrSender.")) } function l(t, e) { var n = new XMLHttpRequest, r = c._senderConfig.endpointUrl(); try { n[dr] = !0 } catch (i) { } n.open("POST", r, e), n.setRequestHeader("Content-type", "application/json"), Hr(r) && n.setRequestHeader(zn.sdkContextHeader, zn.sdkContextHeaderAppIdRequest), ye(be(b), function (e) { n.setRequestHeader(e, b[e]) }), n.onreadystatechange = function () { return c._xhrReadyStateChange(n, t, t.length) }, n.onerror = function (e) { return c._onError(t, m(n), e) }, r = c._buffer.batchPayloads(t), n.send(r), c._buffer.markAsSent(t) } function d(n, e) { var t = c._senderConfig.endpointUrl(), r = c._buffer.batchPayloads(n), r = new Blob([r], { type: "text/plain;charset=UTF-8" }), i = new Headers; Hr(t) && i.append(zn.sdkContextHeader, zn.sdkContextHeaderAppIdRequest), ye(be(b), function (e) { i.append(e, b[e]) }), r = new Request(t, { method: "POST", headers: i, body: r }), fetch(r).then(function (t) { if (!t.ok) throw Error(t.statusText); t.text().then(function (e) { a(t.status, n, t.url, n.length, t.statusText, e) }), c._buffer.markAsSent(n) })["catch"](function (e) { c._onError(n, e.message) }) } function f(e) { try { if (e && "" !== e) { var t = at().parse(e); if (t && t.itemsReceived && t.itemsReceived >= t.itemsAccepted && t.itemsReceived - t.itemsAccepted === t.errors.length) return t } } catch (n) { c.diagLog().throwInternal(E.CRITICAL, G.InvalidBackendResponse, "Cannot parse the response. " + Ae(n), { response: e }) } return null } function p(e, t) { if (void 0 === t && (t = 1), e && 0 !== e.length) { c._buffer.clearSent(e), I++; for (var n = 0, r = e; n < r.length; n++) { var i = r[n]; c._buffer.enqueue(i) } a = I <= 1 ? 10 : (a = 1 + Math.floor((Math.pow(2, I) - 1) / 2 * Math.random() * 10), Math.max(Math.min(a *= t, 3600), 10)), a = ke() + 1e3 * a, x = a, g() } var a } function g() { var e; C || (e = x ? Math.max(0, x - ke()) : 0, e = Math.max(c._senderConfig.maxBatchInterval(), e), C = setTimeout(function () { c.triggerSend(!0, null, 1) }, e)) } function h(e) { return 408 === e || 429 === e || 500 === e || 503 === e } function m(e, t) { return e ? "XMLHttpRequest,Status:" + e.status + ",Response:" + ko(e) || e.response || "" : t } function v(t, e) { var n = Qe(), r = new XDomainRequest; if (r.onload = function () { return c._xdrOnLoad(r, t) }, r.onerror = function (e) { return c._onError(t, i(r), e) }, n = n && n.location && n.location.protocol || "", c._senderConfig.endpointUrl().lastIndexOf(n, 0)) return c.diagLog().throwInternal(E.WARNING, G.TransmissionFailed, ". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."), void c._buffer.clear(); n = c._senderConfig.endpointUrl().replace(/^(https?:)/, ""), r.open("POST", n), n = c._buffer.batchPayloads(t), r.send(n), c._buffer.markAsSent(t) } function i(e, t) { return e ? "XDomainRequest,Response:" + ko(e) || "" : t } function y(e, t) { var n = c.core[n = "getNotifyMgr"] ? c.core[n]() : c.core._notificationManager; if (n && n.eventsSendRequest) try { n.eventsSendRequest(e, t) } catch (r) { c.diagLog().throwInternal(E.CRITICAL, G.NotificationException, "send request notification failed: " + Ae(r), { exception: ct(r) }) } } c.pause = e, c.resume = e, c.flush = function () { try { c.triggerSend(!0, null, 1) } catch (e) { c.diagLog().throwInternal(E.CRITICAL, G.FlushFailed, "flush failed, telemetry will not be collected: " + Ae(e), { exception: ct(e) }) } }, c.onunloadFlush = function () { if (!1 !== c._senderConfig.onunloadDisableBeacon() && !1 !== c._senderConfig.isBeaconApiDisabled() || !or()) c.flush(); else try { c.triggerSend(!0, u, 2) } catch (e) { c.diagLog().throwInternal(E.CRITICAL, G.FailedToSendQueuedTelemetry, "failed to flush with beacon sender on page unload, telemetry will not be collected: " + Ae(e), { exception: ct(e) }) } }, c.teardown = e, c.addHeader = function (e, t) { b[e] = t }, c.initialize = function (e, t, n, r) { o.initialize(e, t, n, r); var i = c._getTelCtx(), a = c.identifier; T = new yo(t.logger), x = null, I = 0, c._sender = null, w = 0, t = _o._getDefaultAppInsightsChannelConfig(), c._senderConfig = _o._getEmptyAppInsightsChannelConfig(), ue(t, function (e, t) { c._senderConfig[e] = function () { return i.getConfig(a, e, t()) } }), c._buffer = c._senderConfig.enableSessionStorageBuffer() && kr() ? new Oa(c.diagLog(), c._senderConfig) : new Ba(c._senderConfig), c._sample = new bo(c._senderConfig.samplingPercentage(), c.diagLog()), !ne((t = e).disableInstrumentationKeyValidation) && t.disableInstrumentationKeyValidation || /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/.test(t.instrumentationKey) || c.diagLog().throwInternal(E.CRITICAL, G.InvalidInstrumentationKey, "Invalid Instrumentation key " + e.instrumentationKey), !Hr(c._senderConfig.endpointUrl()) && c._senderConfig.customHeaders() && 0 < c._senderConfig.customHeaders().length && ye(c._senderConfig.customHeaders(), function (e) { S.addHeader(e.header, e.value) }), !c._senderConfig.isBeaconApiDisabled() && or() ? c._sender = u : (e = Ye("XMLHttpRequest")) ? "withCredentials" in new e ? (c._sender = l, c._XMLHttpRequestSupported = !0) : typeof XDomainRequest !== undefined && (c._sender = v) : Ye("fetch") && (c._sender = d) }, c.processTelemetry = function (e, n) { n = c._getTelCtx(n); try { if (c._senderConfig.disableTelemetry()) return; if (!e) return void n.diagLog().throwInternal(E.CRITICAL, G.CannotSendEmptyTelemetry, "Cannot send empty telemetry"); if (e.baseData && !e.baseType) return void n.diagLog().throwInternal(E.CRITICAL, G.InvalidEvent, "Cannot send telemetry without baseData and baseType"); if (e.baseType || (e.baseType = "EventData"), !c._sender) return void n.diagLog().throwInternal(E.CRITICAL, G.SenderNotInitialized, "Sender was not initialized"); if (!c._sample.isSampledIn(e)) return void n.diagLog().throwInternal(E.WARNING, G.TelemetrySampledAndNotSent, "Telemetry item was sampled out and not sent", { SampleRate: c._sample.sampleRate }); e[fr] = c._sample.sampleRate; var r = _o.constructEnvelope(e, c._senderConfig.instrumentationKey(), n.diagLog()); if (!r) return void n.diagLog().throwInternal(E.CRITICAL, G.CreateEnvelopeError, "Unable to create an AppInsights envelope"); var i = !1; if (e.tags && e.tags[pr] && (ye(e.tags[pr], function (e) { try { e && !1 === e(r) && (i = !0, n.diagLog().warnToConsole("Telemetry processor check returns false")) } catch (t) { n.diagLog().throwInternal(E.CRITICAL, G.TelemetryInitializerFailed, "One of telemetry initializers failed, telemetry item will not be sent: " + Ae(t), { exception: ct(t) }, !0) } }), delete e.tags[pr]), i) return; var t = T.serialize(r), a = c._buffer.getItems(), o = c._buffer.batchPayloads(a); o && o.length + t.length > c._senderConfig.maxBatchSizeInBytes() && c.triggerSend(!0, null, 10), c._buffer.enqueue(t), g() } catch (s) { n.diagLog().throwInternal(E.WARNING, G.FailedAddingTelemetryToBuffer, "Failed adding telemetry to the sender's buffer, some telemetry will be lost: " + Ae(s), { exception: ct(s) }) } c.processNext(e, n) }, c._xhrReadyStateChange = function (e, t, n) { 4 === e.readyState && a(e.status, t, e.responseURL, n, m(e), ko(e) || e.response) }, c.triggerSend = function (e, t, n) { void 0 === e && (e = !0); try { var r; c._senderConfig.disableTelemetry() ? c._buffer.clear() : 0 < c._buffer.count() && (r = c._buffer.getItems(), y(n || 0, e), t ? t.call(S, r, e) : c._sender(r, e)), clearTimeout(C), x = C = null } catch (i) { (!(e = st()) || 9 < e) && c.diagLog().throwInternal(E.CRITICAL, G.TransmissionFailed, "Telemetry transmission failed, some telemetry will be lost: " + Ae(i), { exception: ct(i) }) } }, c._onError = function (e, t, n) { c.diagLog().throwInternal(E.WARNING, G.OnError, "Failed to send telemetry.", { message: t }), c._buffer.clearSent(e) }, c._onPartialSuccess = function (e, t) { for (var n = [], r = [], i = 0, a = t.errors.reverse(); i < a.length; i++) { var o = a[i], s = e.splice(o.index, 1)[0]; (h(o.statusCode) ? r : n).push(s) } 0 < e.length && c._onSuccess(e, t.itemsAccepted), 0 < n.length && c._onError(n, m(null, ["partial success", t.itemsAccepted, "of", t.itemsReceived].join(" "))), 0 < r.length && (p(r), c.diagLog().throwInternal(E.WARNING, G.TransmissionFailed, "Partial success. Delivered: " + e.length + ", Failed: " + n.length + ". Will retry to send " + r.length + " our of " + t.itemsReceived + " items")) }, c._onSuccess = function (e, t) { c._buffer.clearSent(e) }, c._xdrOnLoad = function (e, t) { var n = ko(e); !e || n + "" != "200" && "" !== n ? (n = f(n)) && n.itemsReceived && n.itemsReceived > n.itemsAccepted && !c._senderConfig.isRetryDisabled() ? c._onPartialSuccess(t, n) : c._onError(t, i(e)) : (I = 0, c._onSuccess(t, 0)) } }), S } var Po = "ai_session", Ro = function () { }, Lo = (Do.acquisitionSpan = 864e5, Do.renewalSpan = 18e5, Do.cookieUpdateInterval = 6e4, Do); function Do(e, t) { var d, f, p = ft(t), g = tn(t); K(Do, this, function (c) { function u(e, t) { var n = !1, r = ", session will be reset", i = t.split("|"); if (2 <= i.length) try { var a = +i[1] || 0, o = +i[2] || 0; isNaN(a) || a <= 0 ? p.throwInternal(E.WARNING, G.SessionRenewalDateIsZero, "AI session acquisition date is 0" + r) : isNaN(o) || o <= 0 ? p.throwInternal(E.WARNING, G.SessionRenewalDateIsZero, "AI session renewal date is 0" + r) : i[0] && (e.id = i[0], e.acquisitionDate = a, e.renewalDate = o, n = !0) } catch (s) { p.throwInternal(E.CRITICAL, G.ErrorParsingAISessionCookie, "Error parsing ai_session value [" + (t || "") + "]" + r + " - " + Ae(s), { exception: ct(s) }) } return n } function l(e, t) { var n = e.acquisitionDate; e.renewalDate = t; var r = c.config, i = r.sessionRenewalMs(), a = n + r.sessionExpirationMs() - t, e = [e.id, n, t], n = a < i ? a / 1e3 : i / 1e3, i = r.cookieDomain ? r.cookieDomain() : null; g.set(d(), e.join("|"), 0 < r.sessionExpirationMs() ? n : null, i), f = t } oe((e = e || {}).sessionExpirationMs) || (e.sessionExpirationMs = function () { return Do.acquisitionSpan }), oe(e.sessionRenewalMs) || (e.sessionRenewalMs = function () { return Do.renewalSpan }), c.config = e, d = function () { return c.config.namePrefix && c.config.namePrefix() ? Po + c.config.namePrefix() : Po }, c.automaticSession = new Ro, c.update = function () { var e, t = ke(), n = !1, r = c.automaticSession; r.id || (i = r, s = !1, n = !((s = (e = g.get(d())) && oe(e.split) || (e = Sr(p, d())) ? u(i, e) : s) || i.id)); var i, a, o, s = c.config.sessionExpirationMs(); !n && 0 < s && (a = c.config.sessionRenewalMs(), i = t - r.acquisitionDate, o = t - r.renewalDate, n = (n = (n = i < 0 || o < 0) || s < i) || a < o), n ? (a = t, n = ((o = c.config || {}).getNewId ? o.getNewId() : null) || An, c.automaticSession.id = n(o.idLength ? o.idLength() : 22), c.automaticSession.acquisitionDate = a, l(c.automaticSession, a), wr() || p.throwInternal(E.WARNING, G.BrowserDoesNotSupportLocalStorage, "Browser does not support local storage. Session durations will be inaccurate.")) : (!f || Do.cookieUpdateInterval < t - f) && l(r, t) }, c.backup = function () { var e = (n = c.automaticSession).id, t = n.acquisitionDate, n = n.renewalDate; br(p, d(), [e, t, n].join("|")) } }) } var Mo = function () { }, Fo = function () { this.id = "browser", this.deviceClass = "Browser" }, Uo = function (e) { this.sdkVersion = (e.sdkExtension && e.sdkExtension() ? e.sdkExtension() + "_" : "") + "javascript:2.6.3" }; function qo(e) { return "string" == typeof e && e && !e.match(/,|;|=| |\|/) } var Vo = (Ho.cookieSeparator = "|", Ho.userCookieName = "ai_user", Ho.authUserCookieName = "ai_authUser", Ho); function Ho(i, e) { this.isNewUser = !1; var a = ft(e), o = tn(e); K(Ho, this, function (r) { var e, t = o.get(Ho.userCookieName); t && (r.isNewUser = !1, 0 < (e = t.split(Ho.cookieSeparator)).length && (r.id = e[0])), r.config = i, r.id || (e = ((n = i || {}).getNewId ? n.getNewId() : null) || An, r.id = e(n.idLength ? i.idLength() : 22), n = ve(new Date), r.accountAcquisitionDate = n, r.isNewUser = !0, n = [r.id, n], o.set(Ho.userCookieName, n.join(Ho.cookieSeparator), 31536e3), n = i.namePrefix && i.namePrefix() ? i.namePrefix() + "ai_session" : "ai_session", Er(a, n)), r.accountId = i.accountId ? i.accountId() : undefined; var n = o.get(Ho.authUserCookieName); n && ((n = (n = decodeURI(n)).split(Ho.cookieSeparator))[0] && (r.authenticatedId = n[0]), 1 < n.length && n[1] && (r.accountId = n[1])), r.setAuthenticatedUserContext = function (e, t, n) { void 0 === n && (n = !1), !qo(e) || t && !qo(t) ? a.throwInternal(E.WARNING, G.SetAuthContextFailedAccountName, "Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.", !0) : (r.authenticatedId = e, e = r.authenticatedId, t && (r.accountId = t, e = [r.authenticatedId, r.accountId].join(Ho.cookieSeparator)), n && o.set(Ho.authUserCookieName, encodeURI(e))) }, r.clearAuthenticatedUserContext = function () { r.authenticatedId = null, r.accountId = null, o.del(Ho.authUserCookieName) } }) } var Bo = function () { }, Oo = function (e, t, n, r) { var i = this; i.traceID = e || Nn(), i.parentID = t, i.name = n, t = nt(), !n && t && t.pathname && (i.name = t.pathname), i.name = Gn(r, i.name) }, jo = "ext", zo = "tags"; function Wo(e, t) { e && e[t] && 0 === be(e[t]).length && delete e[t] } var Ko, Go = function Us(e, t) { var r = this, n = e.logger; this.appId = function () { return null }, K(Us, this, function (i) { i.application = new Mo, i.internal = new Uo(t), Ze() && (i.sessionManager = new Lo(t, e), i.device = new Fo, i.location = new Bo, i.user = new Vo(t, e), i.telemetryTrace = new Oo(undefined, undefined, undefined, n), i.session = new Ro), i.applySessionContext = function (e, t) { var n = i.session, r = i.sessionManager; n && ge(n.id) ? Ne(_e(e.ext, xa.AppExt), "sesId", n.id) : r && r.automaticSession && Ne(_e(e.ext, xa.AppExt), "sesId", r.automaticSession.id, ge) }, i.applyOperatingSystemContxt = function (e, t) { Ne(e.ext, xa.OSExt, i.os) }, i.applyApplicationContext = function (e, t) { var n = i.application; n && (Ne(e = _e(e, zo), Ca.applicationVersion, n.ver, ge), Ne(e, Ca.applicationBuild, n.build, ge)) }, i.applyDeviceContext = function (e, t) { var n = i.device; n && (Ne(e = _e(_e(e, jo), xa.DeviceExt), "localId", n.id, ge), Ne(e, "ip", n.ip, ge), Ne(e, "model", n.model, ge), Ne(e, "deviceClass", n.deviceClass, ge)) }, i.applyInternalContext = function (e, t) { var n, r = i.internal; r && (Ne(n = _e(e, zo), Ca.internalAgentVersion, r.agentVersion, ge), Ne(n, Ca.internalSdkVersion, r.sdkVersion, ge), e.baseType !== lt.dataType && e.baseType !== zi.dataType || (Ne(n, Ca.internalSnippet, r.snippetVer, ge), Ne(n, Ca.internalSdkSrc, r.sdkSrc, ge))) }, i.applyLocationContext = function (e, t) { var n = r.location; n && Ne(_e(e, zo, []), Ca.locationIp, n.ip, ge) }, i.applyOperationContext = function (e, t) { var n = i.telemetryTrace; n && (Ne(e = _e(_e(e, jo), xa.TraceExt, { traceID: undefined, parentID: undefined }), "traceID", n.traceID, ge), Ne(e, "name", n.name, ge), Ne(e, "parentID", n.parentID, ge)) }, i.applyWebContext = function (e, t) { var n = r.web; n && Ne(_e(e, jo), xa.WebExt, n) }, i.applyUserContext = function (e, t) { var n = i.user; n && (Ne(_e(e, zo, []), Ca.userAccountId, n.accountId, ge), Ne(e = _e(_e(e, jo), xa.UserExt), "id", n.id, ge), Ne(e, "authId", n.authenticatedId, ge)) }, i.cleanUp = function (e, t) { (e = e.ext) && (Wo(e, xa.DeviceExt), Wo(e, xa.UserExt), Wo(e, xa.WebExt), Wo(e, xa.OSExt), Wo(e, xa.AppExt), Wo(e, xa.TraceExt)) } }) }, Xo = (h(Jo, Ko = bt), Jo.getDefaultConfig = function () { return { instrumentationKey: function () { return undefined }, accountId: function () { return null }, sessionRenewalMs: function () { return 18e5 }, samplingPercentage: function () { return 100 }, sessionExpirationMs: function () { return 864e5 }, cookieDomain: function () { return null }, sdkExtension: function () { return null }, isBrowserLinkTrackingEnabled: function () { return !1 }, appId: function () { return null }, namePrefix: function () { return undefined }, idLength: function () { return 22 }, getNewId: function () { return null } } }, Jo); function Jo() { var c, u, e = Ko.call(this) || this; return e.priority = 110, e.identifier = Ta, K(Jo, e, function (o, s) { o.initialize = function (e, t, n, r) { s.initialize(e, t, n, r); var i = o._getTelCtx(), a = o.identifier, r = Jo.getDefaultConfig(); u = u || {}, ue(r, function (e, t) { u[e] = function () { return i.getConfig(a, e, t()) } }), o.context = new Go(t, u), c = sr(n, wa), o.context.appId = function () { return c ? c._appId : null }, o._extConfig = u }, o.processTelemetry = function (e, t) { var n; ne(e) || (t = o._getTelCtx(t), e.name === zi.envelopeType && t.diagLog().resetInternalMessageCount(), (n = o.context || {}).session && "string" != typeof o.context.session.id && n.sessionManager && n.sessionManager.update(), function (e, t) { _e(e, "tags", []), _e(e, "ext", {}); var n = o.context; n.applySessionContext(e, t), n.applyApplicationContext(e, t), n.applyDeviceContext(e, t), n.applyOperationContext(e, t), n.applyUserContext(e, t), n.applyOperatingSystemContxt(e, t), n.applyWebContext(e, t), n.applyLocationContext(e, t), n.applyInternalContext(e, t), n.cleanUp(e, t) }(e, t), n.user && n.user.isNewUser && (n.user.isNewUser = !1, n = new lt(G.SendBrowserInfoOnUserInit, (tt() || {}).userAgent || ""), t.diagLog().logInternalMessage(E.CRITICAL, n)), o.processNext(e, t)) } }), e } var Yo = "properties"; function Zo(e, t, n) { t = e[t], n = e[n]; return t && n ? Wr(t, n) : 0 } function Qo(e, t, n, r, i) { return (i = Zo(n, r, i)) ? $o(e, t, ar(i)) : 0 } function $o(e, t, n) { var r = "ajaxPerf", i = 0; return e && t && n && ((e[r] = e[r] || {})[t] = n, i = 1), i } var es = function () { var e = this; e.openDone = !1, e.setRequestHeaderDone = !1, e.sendDone = !1, e.abortDone = !1, e.stateChangeAttached = !1 }, ts = function qs(e, t, n) { var r = this, i = n, y = "responseText"; r.perfMark = null, r.completed = !1, r.requestHeadersSize = null, r.requestHeaders = null, r.responseReceivingDuration = null, r.callbackDuration = null, r.ajaxTotalDuration = null, r.aborted = 0, r.pageUrl = null, r.requestUrl = null, r.requestSize = 0, r.method = null, r.status = null, r.requestSentTime = null, r.responseStartedTime = null, r.responseFinishedTime = null, r.callbackFinishedTime = null, r.endTime = null, r.xhrMonitoringState = new es, r.clientFailure = 0, r.traceID = e, r.spanID = t, K(qs, r, function (v) { v.getAbsoluteUrl = function () { return v.requestUrl ? Mr(v.requestUrl) : null }, v.getPathName = function () { return v.requestUrl ? Xn(i, Fr(v.method, v.requestUrl)) : null }, v.CreateTrackItem = function (e, t, n) { return v.ajaxTotalDuration = Math.round(1e3 * Wr(v.requestSentTime, v.responseFinishedTime)) / 1e3, v.ajaxTotalDuration < 0 ? null : ((e = { id: "|" + v.traceID + "." + v.spanID, target: v.getAbsoluteUrl(), name: v.getPathName(), type: e, startTime: null, duration: v.ajaxTotalDuration, success: 200 <= +v.status && +v.status < 400, responseCode: +v.status, method: v.method })[Yo] = { HttpMethod: v.method }, v.requestSentTime && (e.startTime = new Date, e.startTime.setTime(v.requestSentTime)), i = e, o = (r = v).perfTiming, s = i[Yo] || {}, c = 0, u = "startTime", l = "connect" + "End", d = "request" + "Start", f = "response" + "End", p = "transferSize", g = "encodedBodySize", h = "decodedBodySize", m = "serverTiming", o ? (c |= Qo(s, "End", o, "redirectStart", "End"), c |= Qo(s, "domainLookup", o, "domainLookupStart", "domainLookupEnd"), c |= Qo(s, "connect", o, "connectStart", l), c |= Qo(s, "request", o, d, "requestEnd"), c |= Qo(s, "response", o, "responseStart", f), c |= Qo(s, "networkConnect", o, u, l), c |= Qo(s, "sentRequest", o, d, f), c |= $o(s, "duration", f = o.duration || Zo(o, u, f) || 0), c |= $o(s, "perfTotal", f), (f = o[m]) && (a = {}, ye(f, function (e, t) { var n, r = (r = n = e.name || "" + t, (t = /([^\w\d_$])/g).test(n) ? n.replace(t, "_") : r), i = a[r] || {}; ue(e, function (e, t) { ("name" !== e && ge(t) || he(t)) && (!(t = i[e] ? i[e] + ";" + t : t) && ge(t) || (i[e] = t)) }), a[r] = i }), c |= $o(s, m, a)), c |= $o(s, p, o[p]), c |= $o(s, g, o[g]), c |= $o(s, h, o[h])) : r.perfMark && (c |= $o(s, "missing", r.perfAttempts)), c && (i[Yo] = s), t && 0 < be(v.requestHeaders).length && (e[Yo] = e[Yo] || {}, e[Yo].requestHeaders = v.requestHeaders), !n || (t = n()) && ((n = t.correlationContext) && (e.correlationContext = n), t.headerMap && 0 < be(t.headerMap).length && (e[Yo] = e[Yo] || {}, e[Yo].responseHeaders = t.headerMap), 400 <= v.status && (n = t.type, e[Yo] = e[Yo] || {}, "" !== n && "text" !== n || (e[Yo][y] = t[y] ? t.statusText + " - " + t[y] : t.statusText), "json" === n && (e[Yo][y] = t.response ? t.statusText + " - " + JSON.stringify(t.response) : t.statusText))), e); var r, i, a, o, s, c, u, l, d, f, p, g, h, m } }) }, ns = (rs.isValidTraceId = function (e) { return e.match(/^[0-9a-f]{32}$/) && "00000000000000000000000000000000" !== e }, rs.isValidSpanId = function (e) { return e.match(/^[0-9a-f]{16}$/) && "0000000000000000" !== e }, rs.prototype.toString = function () { return this.version + "-" + this.traceId + "-" + this.spanId + "-" + this.traceFlag }, rs.DEFAULT_TRACE_FLAG = "01", rs.DEFAULT_VERSION = "00", rs); function rs(e, t) { var n = this; n.traceFlag = rs.DEFAULT_TRACE_FLAG, n.version = rs.DEFAULT_VERSION, e && rs.isValidTraceId(e) ? n.traceId = e : n.traceId = Nn(), t && rs.isValidSpanId(t) ? n.spanId = t : n.spanId = Nn().substr(0, 16) } var is = "ai.ajxmn.", as = "diagLog", os = "ajaxData", ss = "throwInternal", cs = "fetch", us = 0; function ls(e) { var t = !1; typeof XMLHttpRequest === s || ne(XMLHttpRequest) || (t = !(ne(n = XMLHttpRequest[D]) || ne(n.open) || ne(n.send) || ne(n.abort))); var n = st(); if (t = !(n && n < 9) && t) try { (new XMLHttpRequest)[os] = {}; var r = XMLHttpRequest[D].open; XMLHttpRequest[D].open = r } catch (i) { t = !1, fs(e, G.FailedMonitorAjaxOpen, "Failed to enable XMLHttpRequest monitoring, extension is not supported", { exception: ct(i) }) } return t } function ds(e) { var t = ""; try { ne(e) || ne(e[os]) || ne(e[os].requestUrl) || (t += "(url: '" + e[os].requestUrl + "')") } catch (n) { } return t } function fs(e, t, n, r, i) { e[as]()[ss](E.CRITICAL, t, n, r, i) } function ps(e, t, n, r, i) { e[as]()[ss](E.WARNING, t, n, r, i) } function gs(t, n, r) { return function (e) { fs(t, n, r, { ajaxDiagnosticsMessage: ds(e.inst), exception: ct(e.err) }) } } function hs(e, t) { return e && t ? e.indexOf(t) : -1 } var ms, vs, ys = (h(Is, ms = bt), Is.getDefaultConfig = function () { return { maxAjaxCallsPerView: 500, disableAjaxTracking: !1, disableFetchTracking: !0, disableCorrelationHeaders: !1, distributedTracingMode: lr.AI_AND_W3C, correlationHeaderExcludedDomains: ["*.blob.core.windows.net", "*.blob.core.chinacloudapi.cn", "*.blob.core.cloudapi.de", "*.blob.core.usgovcloudapi.net"], correlationHeaderDomains: undefined, correlationHeaderExcludePatterns: undefined, appId: undefined, enableCorsCorrelation: !1, enableRequestHeaderTracking: !1, enableResponseHeaderTracking: !1, enableAjaxErrorStatusText: !1, enableAjaxPerfTracking: !1, maxAjaxPerfLookupAttempts: 3, ajaxPerfLookupDelay: 25, ignoreHeaders: ["Authorization", "X-API-Key", "WWW-Authenticate"] } }, Is.getEmptyConfig = function () { var t = this.getDefaultConfig(); return ue(t, function (e) { t[e] = undefined }), t }, Is.prototype.processTelemetry = function (e, t) { this.processNext(e, t) }, Is.identifier = "AjaxDependencyPlugin", Is); function Is() { var e = ms.call(this) || this; e.identifier = Is.identifier, e.priority = 120; var I, x, C, T, w, S, b = "trackDependencyDataInternal", t = nt(), E = !1, k = !1, A = t && t.host && t.host.toLowerCase(), N = Is.getEmptyConfig(), _ = !1, r = 0, P = 0, R = [], L = {}; return K(Is, e, function (u, l) { function d(t) { var n = !0; return (t || N.ignoreHeaders) && ye(N.ignoreHeaders, function (e) { if (e.toLowerCase() == t.toLowerCase()) return n = !1, -1 }), n } function f(e, t, n) { R.push(e ? jn(e[D], t, n, !1) : null) } function p(e, t, n) { var r = !1, i = ((ge(t) ? t : (t || {}).url || "") || "").toLowerCase(), a = hs(i, "?"), o = hs(i, "#"); return -1 !== (a = -1 === a || -1 !== o && o < a ? o : a) && (i = i.substring(0, a)), ne(e) ? ne(t) || (r = "object" == typeof t && !0 === t[dr] || !!n && !0 === n[dr]) : r = !0 === e[dr] || !0 === i[dr], r ? L[i] || (L[i] = 1) : L[i] && (r = !0), r } function g(e, t) { var n = !0, r = k; return ne(e) || (n = !0 === t || !ne(e[os])), r && n } function h(a) { a[os].xhrMonitoringState.stateChangeAttached = Rn.Attach(a, "readystatechange", function () { try { a && 4 === a.readyState && g(a) && ((i = (r = a)[os]).responseFinishedTime = zr(), i.status = r.status, s("xmlhttprequest", i, function () { try { var e = i.CreateTrackItem("Ajax", _, function () { var e, n, t = { statusText: r.statusText, headerMap: null, correlationContext: o(r), type: r.responseType, responseText: function (e) { try { var t = e.responseType; if ("" === t || "text" === t) return e.responseText } catch (n) { } return null }(r), response: r.response }; return !S || (e = r.getAllResponseHeaders()) && (e = Te(e).split(/[\r\n]+/), n = {}, ye(e, function (e) { var e = (t = e.split(": ")).shift(), t = t.join(": "); d(e) && (n[e] = t) }), t.headerMap = n), t }); e ? u[b](e) : n(null, { requestSentTime: i.requestSentTime, responseFinishedTime: i.responseFinishedTime }) } finally { try { r[os] = null } catch (t) { } } }, function (e) { n(e, null) })) } catch (t) { var e = ct(t); e && -1 !== hs(e.toLowerCase(), "c00c023f") || fs(u, G.FailedMonitorAjaxRSC, "Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.", { ajaxDiagnosticsMessage: ds(a), exception: e }) } function n(e, t) { (t = t || {}).ajaxDiagnosticsMessage = ds(r), e && (t.exception = ct(e)), ps(u, G.FailedMonitorAjaxDur, "Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.", t) } var r, i }) } function o(e) { try { var t = e.getAllResponseHeaders(); if (null !== t && -1 !== hs(t.toLowerCase(), zn.requestContextHeaderLowerCase)) { var n = e.getResponseHeader(zn.requestContextHeader); return jr.getCorrelationContext(n) } } catch (r) { ps(u, G.FailedMonitorAjaxGetCorrelationHeader, "Failed to get Request-Context correlation header as it may be not included in the response or not accessible.", { ajaxDiagnosticsMessage: ds(e), exception: ct(r) }) } } function m(e, t) { var n; t.requestUrl && T && w && (n = rt()) && oe(n.mark) && (e = T + e + "#" + ++us, n.mark(e), (e = n.getEntriesByName(e)) && 1 === e.length && (t.perfMark = e[0])) } function s(a, o, s, c) { var u = o.perfMark, l = rt(), d = N.maxAjaxPerfLookupAttempts, f = N.ajaxPerfLookupDelay, p = o.requestUrl, g = 0; !function h() { try { if (l && u) { g++; for (var e = null, t = l.getEntries(), n = t.length - 1; 0 <= n; n--) { var r = t[n]; if (r) { if ("resource" === r.entryType) r.initiatorType !== a || -1 === hs(r.name, p) && -1 === hs(p, r.name) || (e = r); else if ("mark" === r.entryType && r.name === u.name) { o.perfTiming = e; break } if (r.startTime < u.startTime - 1e3) break } } } !u || o.perfTiming || d <= g || !1 === o["async"] ? (u && oe(l.clearMarks) && l.clearMarks(u.name), o.perfAttempts = g, s()) : setTimeout(h, f) } catch (i) { c(i) } }() } function c(e) { var t = ""; try { ne(e) || (t += "string" == typeof e ? "(url: '" + e + "')" : "(url: '" + e.url + "')") } catch (n) { fs(u, G.FailedMonitorAjaxOpen, "Failed to grab failed fetch diagnostics message", { exception: ct(n) }) } return t } function v(e, t, r, n, i) { function a(e, t, n) { (n = n || {}).fetchDiagnosticsMessage = c(r), t && (n.exception = ct(t)), ps(u, e, "Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.", n) } n && (n.responseFinishedTime = zr(), n.status = t, s("fetch", n, function () { var e = n.CreateTrackItem("Fetch", _, i); e ? u[b](e) : a(G.FailedMonitorAjaxDur, null, { requestSentTime: n.requestSentTime, responseFinishedTime: n.responseFinishedTime }) }, function (e) { a(G.FailedMonitorAjaxGetCorrelationHeader, e, null) })) } function y(e) { if (e && e.headers) try { var t = e.headers.get(zn.requestContextHeader); return jr.getCorrelationContext(t) } catch (n) { ps(u, G.FailedMonitorAjaxGetCorrelationHeader, "Failed to get Request-Context correlation header as it may be not included in the response or not accessible.", { fetchDiagnosticsMessage: c(e), exception: ct(n) }) } } u.initialize = function (e, t, n, r) { if (!u.isInitialized()) { l.initialize(e, t, n, r); var i = u._getTelCtx(); if (ue(Is.getDefaultConfig(), function (e, t) { N[e] = i.getConfig(Is.identifier, e, t) }), r = N.distributedTracingMode, _ = N.enableRequestHeaderTracking, w = N.enableAjaxPerfTracking, P = N.maxAjaxCallsPerView, S = N.enableResponseHeaderTracking, C = r === lr.AI || r === lr.AI_AND_W3C, x = r === lr.AI_AND_W3C || r === lr.W3C, w && (s = e.instrumentationKey || "unkwn", T = 5 < s.length ? is + s.substring(s.length - 5) + "." : is + s + "."), !1 === N.disableAjaxTracking && ls(u) && !k && (f(XMLHttpRequest, "open", { req: function (e, t, n, r) { var i = e.inst, a = i[os]; p(i, n) || !g(i, !0) || a && a.xhrMonitoringState.openDone || (e = i, a = t, i = n, t = r, n = I && I.telemetryTrace && I.telemetryTrace.traceID || Nn(), r = Nn().substr(0, 16), (r = new ts(n, r, u[as]())).method = a, r.requestUrl = i, r.xhrMonitoringState.openDone = !0, r.requestHeaders = {}, r["async"] = t, e[os] = r, h(e)) }, hkErr: gs(u, G.FailedMonitorAjaxOpen, "Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.") }), f(XMLHttpRequest, "send", { req: function (e, t) { var n = e.inst, e = n[os]; g(n) && !e.xhrMonitoringState.sendDone && (m("xhr", e), e.requestSentTime = zr(), u.includeCorrelationHeaders(e, undefined, undefined, n), e.xhrMonitoringState.sendDone = !0) }, hkErr: gs(u, G.FailedMonitorAjaxSend, "Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.") }), f(XMLHttpRequest, "abort", { req: function (e) { var t = e.inst, e = t[os]; g(t) && !e.xhrMonitoringState.abortDone && (e.aborted = 1, e.xhrMonitoringState.abortDone = !0) }, hkErr: gs(u, G.FailedMonitorAjaxAbort, "Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.") }), _ && f(XMLHttpRequest, "setRequestHeader", { req: function (e, t, n) { g(e = e.inst) && d(t) && (e[os].requestHeaders[t] = n) }, hkErr: gs(u, G.FailedMonitorAjaxSetRequestHeader, "Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.") }), k = !0), (e = !(r = M()) || ne(r.Request) || ne(r.Request[D]) || ne(r[cs]) ? null : r[cs]) && (s = M(), c = e.polyfill, !1 === N.disableFetchTracking ? (R.push(jn(s, cs, { req: function (e, t, n) { var r, i; !E || p(null, t, n) || c && k || (r = e.ctx(), i = function (e, t) { var n = I && I.telemetryTrace && I.telemetryTrace.traceID || Nn(), r = Nn().substr(0, 16); (n = new ts(n, r, u[as]())).requestSentTime = zr(), e instanceof Request ? n.requestUrl = e ? e.url : "" : n.requestUrl = e, r = "GET", t && t.method ? r = t.method : e && e instanceof Request && (r = e.method), n.method = r; var i = {}; return _ && new Headers((t ? t.headers : 0) || e instanceof Request && e.headers || {}).forEach(function (e, t) { d(t) && (i[t] = e) }), n.requestHeaders = i, m("fetch", n), n }(t, n), (t = u.includeCorrelationHeaders(i, t, n)) !== n && e.set(1, t), r.data = i) }, rsp: function (e, t) { var n = e.ctx().data; n && (e.rslt = e.rslt.then(function (t) { return v(0, (t || {}).status, t, n, function () { var n, e = { statusText: t.statusText, headerMap: null, correlationContext: y(t) }; return S && (n = {}, t.headers.forEach(function (e, t) { d(t) && (n[t] = e) }), e.headerMap = n), e }), t })["catch"](function (e) { throw v(0, 0, t, n, null, e.message), e })) }, hkErr: gs(u, G.FailedMonitorAjaxOpen, "Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.") })), E = !0) : c && R.push(jn(s, cs, { req: function (e, t, n) { p(null, t, n) } })), c && (s[cs].polyfill = c)), 0 < n.length && n) { for (var a = void 0, o = 0; !a && o < n.length;)n[o] && n[o].identifier === Ta && (a = n[o]), o++; a && (I = a.context) } } var s, c }, u.teardown = function () { ye(R, function (e) { e.rm() }), k = E = !(R = []), u.setInitialized(!1) }, u.trackDependencyData = function (e, t) { u[b](e, t) }, u.includeCorrelationHeaders = function (e, t, n, r) { var i, a, o, s = u._currentWindowHost || A; return t ? (jr.canIncludeCorrelationHeader(N, e.getAbsoluteUrl(), s) && ((n = n || {}).headers = new Headers(n.headers || t instanceof Request && t.headers || {}), C && (i = "|" + e.traceID + "." + e.spanID, n.headers.set(zn.requestIdHeader, i), _ && (e.requestHeaders[zn.requestIdHeader] = i)), (a = N.appId || I && I.appId()) && (n.headers.set(zn.requestContextHeader, zn.requestContextAppIdFormat + a), _ && (e.requestHeaders[zn.requestContextHeader] = zn.requestContextAppIdFormat + a)), x && (o = new ns(e.traceID, e.spanID), n.headers.set(zn.traceParentHeader, o.toString()), _ && (e.requestHeaders[zn.traceParentHeader] = o.toString()))), n) : r ? (jr.canIncludeCorrelationHeader(N, e.getAbsoluteUrl(), s) && (C && (i = "|" + e.traceID + "." + e.spanID, r.setRequestHeader(zn.requestIdHeader, i), _ && (e.requestHeaders[zn.requestIdHeader] = i)), (a = N.appId || I && I.appId()) && (r.setRequestHeader(zn.requestContextHeader, zn.requestContextAppIdFormat + a), _ && (e.requestHeaders[zn.requestContextHeader] = zn.requestContextAppIdFormat + a)), x && (o = new ns(e.traceID, e.spanID), r.setRequestHeader(zn.traceParentHeader, o.toString()), _ && (e.requestHeaders[zn.traceParentHeader] = o.toString()))), r) : undefined }, u[b] = function (e, t, n) { -1 === P || r < P ? (N.distributedTracingMode !== lr.W3C && N.distributedTracingMode !== lr.AI_AND_W3C || "string" != typeof e.id || "." === e.id[e.id.length - 1] || (e.id += "."), ne(e.startTime) && (e.startTime = new Date), n = ya.create(e, Gi.dataType, Gi.envelopeType, u[as](), t, n), u.core.track(n)) : r === P && fs(u, G.MaxAjaxPerPVExceeded, "Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.", !0), ++r } }), e } var xs = ["snippet", "dependencies", "properties", "_snippetVersion", "appInsightsNew", "getSKUDefaults"], sa = { __proto__: null, PropertiesPluginIdentifier: Ta, BreezeChannelIdentifier: wa, AnalyticsPluginIdentifier: Sa, Util: Br, CorrelationIdHelper: jr, UrlHelper: Or, DateTimeUtils: Kr, ConnectionStringParser: Zr, FieldType: { Default: 0, Required: 1, Array: 2, Hidden: 4 }, RequestHeaders: zn, DisabledPropertyName: dr, ProcessLegacy: pr, SampleRate: fr, HttpMethod: gr, DEFAULT_BREEZE_ENDPOINT: hr, AIData: $r, AIBase: Qr, Envelope: ni, Event: ai, Exception: Si, Metric: qi, PageView: zi, PageViewData: Bi, RemoteDependencyData: Gi, Trace: Yi, PageViewPerformance: ta, Data: aa, SeverityLevel: ia, ConfigurationManager: sa, ContextTagKeys: ma, DataSanitizer: nr, TelemetryItemCreator: ya, CtxTagKeys: Ca, Extensions: xa, DistributedTracingModes: lr }, Cs = (Ts.prototype.getCookieMgr = function () { return this.appInsights.getCookieMgr() }, Ts.prototype.trackEvent = function (e, t) { this.appInsights.trackEvent(e, t) }, Ts.prototype.trackPageView = function (e) { this.appInsights.trackPageView(e || {}) }, Ts.prototype.trackPageViewPerformance = function (e) { this.appInsights.trackPageViewPerformance(e || {}) }, Ts.prototype.trackException = function (e) { e && !e.exception && e.error && (e.exception = e.error), this.appInsights.trackException(e) }, Ts.prototype._onerror = function (e) { this.appInsights._onerror(e) }, Ts.prototype.trackTrace = function (e, t) { this.appInsights.trackTrace(e, t) }, Ts.prototype.trackMetric = function (e, t) { this.appInsights.trackMetric(e, t) }, Ts.prototype.startTrackPage = function (e) { this.appInsights.startTrackPage(e) }, Ts.prototype.stopTrackPage = function (e, t, n, r) { this.appInsights.stopTrackPage(e, t, n, r) }, Ts.prototype.startTrackEvent = function (e) { this.appInsights.startTrackEvent(e) }, Ts.prototype.stopTrackEvent = function (e, t, n) { this.appInsights.stopTrackEvent(e, t, n) }, Ts.prototype.addTelemetryInitializer = function (e) { return this.appInsights.addTelemetryInitializer(e) }, Ts.prototype.setAuthenticatedUserContext = function (e, t, n) { this.properties.context.user.setAuthenticatedUserContext(e, t, n = void 0 !== n && n) }, Ts.prototype.clearAuthenticatedUserContext = function () { this.properties.context.user.clearAuthenticatedUserContext() }, Ts.prototype.trackDependencyData = function (e) { this.dependencies.trackDependencyData(e) }, Ts.prototype.flush = function (t) { var e = this; void 0 === t && (t = !0), It(this.core, function () { return "AISKU.flush" }, function () { ye(e.core.getTransmissionControls(), function (e) { ye(e, function (e) { e.flush(t) }) }) }, null, t) }, Ts.prototype.onunloadFlush = function (t) { void 0 === t && (t = !0), ye(this.core.getTransmissionControls(), function (e) { ye(e, function (e) { e.onunloadFlush ? e.onunloadFlush() : e.flush(t) }) }) }, Ts.prototype.loadAppInsights = function (t, r, i) { var a = this, o = this; return (t = void 0 !== t && t) && o.config.extensions && 0 < o.config.extensions.length && Le("Extensions not allowed in legacy mode"), It(o.core, function () { return "AISKU.loadAppInsights" }, function () { var n, e = []; e.push(o._sender), e.push(o.properties), e.push(o.dependencies), e.push(o.appInsights), o.core.initialize(o.config, e, r, i), o.context = o.properties.context, vs && o.context && (o.context.internal.sdkSrc = vs), (n = o.snippet) && (e = "", ne(o._snippetVersion) || (e += o._snippetVersion), t && (e += ".lg"), o.context && o.context.internal && (o.context.internal.snippetVer = e || "-"), ue(o, function (e, t) { ge(e) && !oe(t) && e && "_" !== e[0] && !~xs.indexOf(e) && (n[e] = t) })), o.emptyQueue(), o.pollInternalLogs(), o.addHousekeepingBeforeUnload(a) }), o }, Ts.prototype.updateSnippetDefinitions = function (e) { De(e, this, function (e) { return e && !~xs.indexOf(e) }) }, Ts.prototype.emptyQueue = function () { var e = this; try { if (fe(e.snippet.queue)) { for (var t = e.snippet.queue.length, n = 0; n < t; n++)(0, e.snippet.queue[n])(); e.snippet.queue = undefined, delete e.snippet.queue } } catch (r) { r && oe(r.toString) && r.toString() } }, Ts.prototype.pollInternalLogs = function () { this.core.pollInternalLogs() }, Ts.prototype.addHousekeepingBeforeUnload = function (e) { var t, n; (Ze() || $e()) && (t = function () { e.onunloadFlush(!1), ye(e.appInsights.core._extensions, function (e) { if (e.identifier === Ta) return e && e.context && e.context._sessionManager && e.context._sessionManager.backup(), -1 }) }, e.appInsights.config.disableFlushOnBeforeUnload || (n = kn("beforeunload", t), n = kn("unload", t) || n, (n = kn("pagehide", t) || n) || (n = tt()) && n.product && "ReactNative" === n.product || e.appInsights.core.logger.throwInternal(E.CRITICAL, G.FailedToAddHandlerForOnBeforeUnload, "Could not add handler for beforeunload and pagehide")), e.appInsights.config.disableFlushOnUnload || kn("pagehide", t)) }, Ts.prototype.getSender = function () { return this._sender }, Ts.prototype.getSKUDefaults = function () { this.config.diagnosticLogInterval = this.config.diagnosticLogInterval && 0 < this.config.diagnosticLogInterval ? this.config.diagnosticLogInterval : 1e4 }, Ts); function Ts(e) { var t = this; t._snippetVersion = "" + (e.sv || e.version || ""), e.queue = e.queue || [], e.version = e.version || 2; var n, r, i = e.config || {}; i.connectionString && (r = (n = Jr(i.connectionString)).ingestionendpoint, i.endpointUrl = r ? r + "/v2/track" : i.endpointUrl, i.instrumentationKey = n.instrumentationkey || i.instrumentationKey), t.appInsights = new qa, t.properties = new Xo, t.dependencies = new ys, t.core = new pn, t._sender = new No, t.snippet = e, t.config = i, t.getSKUDefaults() } function ws() { } !function () { var e = null, t = ["://js.monitor.azure.com/", "://az416426.vo.msecnd.net/"]; try { var n = (document || {}).currentScript; n && (e = n.src) } catch (o) { } if (e) try { var r = e.toLowerCase(); if (r) for (var i = "", a = 0; a < t.length; a++)if (~r.indexOf(t[a])) { i = "cdn" + (a + 1), ~r.indexOf("/scripts/") || (~r.indexOf("/next/") ? i += "-next" : ~r.indexOf("/beta/") && (i += "-beta")), vs = i + ""; break } } catch (o) { } }(), ws.getAppInsights = function (e, t) { var n = new Cs(e), r = 2 !== t; return Ln(), 2 === t ? (n.updateSnippetDefinitions(e), n.loadAppInsights(r), n) : ((t = new Ea(e, n)).updateSnippetDefinitions(e), n.loadAppInsights(r), t) }; var Ss, bs, Es, nr = ws, ks = "undefined"; function As(e, t) { var n = typeof console != ks ? console : null; n && n.warn && n.warn("Failed to initialize AppInsights JS SDK for instance " + (e || "<unknown>") + " - " + t) } try { typeof window != ks ? (Es = (Ss = window).appInsightsSDK || "appInsights", typeof JSON != ks ? Ss[Es] === undefined || (2 <= (bs = Ss[Es] || { version: 2 }).version && Ss[Es].initialize || bs.version === undefined) && nr.getAppInsights(bs, bs.version) : As(Es, "Missing JSON - you must supply a JSON polyfill!")) : As(Es, "Missing window") } catch (Vs) { As(Es, Vs.message) } e.ApplicationInsights = Cs, e.Telemetry = sa, function (e, t, n) { var r = Object.defineProperty; if (r) try { return r(e, t, n) } catch (Vs) { } typeof n.value !== undefined && (e[t] = n.value) }(e, "__esModule", { value: !0 }) }; "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define(["exports"], t) : t(((e = "undefined" != typeof globalThis ? globalThis : e || self).Microsoft = e.Microsoft || {}, e.Microsoft.ApplicationInsights = e.Microsoft.ApplicationInsights || {}));
//# sourceMappingURL=ai.2.6.3.min.js.map